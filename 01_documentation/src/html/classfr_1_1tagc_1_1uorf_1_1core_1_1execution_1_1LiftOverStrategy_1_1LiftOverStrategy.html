<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sORFdatafreezer: fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sORFdatafreezer
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>fr</b></li><li class="navelem"><b>tagc</b></li><li class="navelem"><b>uorf</b></li><li class="navelem"><b>core</b></li><li class="navelem"><b>execution</b></li><li class="navelem"><b>LiftOverStrategy</b></li><li class="navelem"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html">LiftOverStrategy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Inherits object.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a495461c3bc1d754c94c4e0d4fe9125e6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#a495461c3bc1d754c94c4e0d4fe9125e6">__init__</a> (self)</td></tr>
<tr class="separator:a495461c3bc1d754c94c4e0d4fe9125e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f520046cb34579abe83a36ded6be151"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#a4f520046cb34579abe83a36ded6be151">execute</a> (self)</td></tr>
<tr class="separator:a4f520046cb34579abe83a36ded6be151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5abc0e6b46bc71833c0ed2a43b37a50"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#ac5abc0e6b46bc71833c0ed2a43b37a50">convert_genomic_coordinates</a> (self)</td></tr>
<tr class="separator:ac5abc0e6b46bc71833c0ed2a43b37a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac31829ac1f9eb4fb74b852109f18dd6b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#ac31829ac1f9eb4fb74b852109f18dd6b">compute_dsorf_gen_len</a> (self)</td></tr>
<tr class="separator:ac31829ac1f9eb4fb74b852109f18dd6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af92105654885b40282c36ecd4fcbc26f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#af92105654885b40282c36ecd4fcbc26f">convert_coord</a> (chr, strand, position, lo)</td></tr>
<tr class="separator:af92105654885b40282c36ecd4fcbc26f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af278e4c4a9e4e1e631401173b4f1db0a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#af278e4c4a9e4e1e631401173b4f1db0a">convert_dsorf_coordinates</a> (dsorf, lo)</td></tr>
<tr class="separator:af278e4c4a9e4e1e631401173b4f1db0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb23d55a3787303bd7396b0072cf632"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#accb23d55a3787303bd7396b0072cf632">reset_dsorf</a> (dsorf)</td></tr>
<tr class="separator:accb23d55a3787303bd7396b0072cf632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5387ffa97a5647ee14409ed06767af47"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#a5387ffa97a5647ee14409ed06767af47">duplicate_dsorf_coordinates</a> (dsorf)</td></tr>
<tr class="separator:a5387ffa97a5647ee14409ed06767af47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7040512fdc03b128eaffa69be93e718"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#ac7040512fdc03b128eaffa69be93e718">convert_dstranscript_coordinates</a> (dstranscript, lo)</td></tr>
<tr class="separator:ac7040512fdc03b128eaffa69be93e718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad552f23dae8c495d2779af294e615368"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#ad552f23dae8c495d2779af294e615368">reset_dstranscript</a> (dstranscript)</td></tr>
<tr class="separator:ad552f23dae8c495d2779af294e615368"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65a9326a6f986b1442a4fd78530c82c1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#a65a9326a6f986b1442a4fd78530c82c1">duplicate_dstranscript_coordinates</a> (dstranscript)</td></tr>
<tr class="separator:a65a9326a6f986b1442a4fd78530c82c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae871fc781f95233d620c9f83839633cd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#ae871fc781f95233d620c9f83839633cd">compute_gen_len</a> (spliced, start_pos, stop_pos, splice_starts, splice_ends, raw_len)</td></tr>
<tr class="separator:ae871fc781f95233d620c9f83839633cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a8a2ffe980c764280a4bb5a029c99d93b"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html#a8a2ffe980c764280a4bb5a029c99d93b">CHAIN_FILE_URL</a></td></tr>
<tr class="separator:a8a2ffe980c764280a4bb5a029c99d93b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html">LiftOverStrategy</a> </h1>
<p>This class is a strategy aiming to convert all the genomic coordinates contained in the DS database (in DSORF and DSTranscript table) from a genome annotation version to the current one. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a495461c3bc1d754c94c4e0d4fe9125e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495461c3bc1d754c94c4e0d4fe9125e6">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Constructor of <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1LiftOverStrategy_1_1LiftOverStrategy.html">LiftOverStrategy</a> </h2>
<p>Instance variables:</p><ul>
<li>configfile: String - The path to the config file.</li>
<li>species: String - The name of the species in the database.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When the config file is not provided or cannot be found at the path provided. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">def </span>__init__( self ):</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        configfile = OptionManager.get_instance().get_option( OptionConstants.OPTION_CONFIG_FILE_PATH, </div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                              not_none=<span class="keyword">True</span> )</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">if</span> configfile:</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            self.configfile = configfile</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> os.path.exists( configfile ) ):</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;No config file may be found at the path provided (&#39;</span> + </div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                           self.configfile + <span class="stringliteral">&#39;).&#39;</span> )</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;A config file has to be provided.&#39;</span> +</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                       <span class="stringliteral">&#39; Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        self.species = <span class="keywordtype">None</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac31829ac1f9eb4fb74b852109f18dd6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac31829ac1f9eb4fb74b852109f18dd6b">&#9670;&nbsp;</a></span>compute_dsorf_gen_len()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.compute_dsorf_gen_len </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>compute_dsorf_gen_len </h2>
<p>This method allows to compute the genomic lengths (using the coordinates in the original and current genome version) for all the DSORF entries of the database. The absolute difference between these lengths is then computed. </p>
<div class="fragment"><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keyword">def </span>compute_dsorf_gen_len( self ):</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        </div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Starting to compute the genomic lengths for all the entries&#39;</span> +</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                    <span class="stringliteral">&#39; of the DSORF table.&#39;</span> )</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        </div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="comment"># Get all the DSORF entries</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        all_dsorfs_query = SQLManagerDS.get_instance().get_session().query( DSORF )</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        all_dsorfs = all_dsorfs_query.all()</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="comment"># Get the number of rows expected to be treated and </span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment"># reset the ProgressionBar instance</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        ProgressionBar.get_instance().reset_instance( total = all_dsorfs_query.count() )</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        </div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="comment"># Instantiate an empty list to receive all the DSORF entries </span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="comment"># that have to be updated</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        updated_objects = []</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">for</span> dsorf <span class="keywordflow">in</span> all_dsorfs:</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            </div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                </div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <span class="comment"># Compute the genomic length from provided coordinates</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            dsorf.raw_genomic_length = self.compute_gen_len( spliced = dsorf.spliced,</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                                             start_pos = dsorf.raw_start_pos, </div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                                             stop_pos = dsorf.raw_stop_pos, </div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                                             splice_starts = dsorf.raw_splice_starts, </div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                                             splice_ends = dsorf.raw_splice_ends,</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                                             raw_len = <span class="keyword">True</span> )</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            </div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="comment"># Compute the genomic length from the coordinates after liftOver</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            dsorf.genomic_length = self.compute_gen_len( spliced = dsorf.spliced,</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                                         start_pos = dsorf.start_pos, </div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                                         stop_pos = dsorf.stop_pos, </div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                                         splice_starts = dsorf.splice_starts, </div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                                         splice_ends = dsorf.splice_ends,</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                                         raw_len = <span class="keyword">False</span> )</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                </div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <span class="comment"># Compute the difference between the genomic lengths</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="comment"># when both are available</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">if</span> ( ( dsorf.raw_genomic_length == <span class="keywordtype">None</span> ) </div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                 <span class="keywordflow">or</span> ( dsorf.genomic_length == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                dsorf.genomic_length_diff = <span class="keywordtype">None</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                dsorf.genomic_length_diff = abs( dsorf.raw_genomic_length - dsorf.genomic_length )</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment"># Check if the liftover failed for at least one</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <span class="comment"># of the positions and register the information</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            dsorf.liftover_succeed = <span class="keyword">True</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            <span class="keywordflow">if</span> ( ( dsorf.start_pos == <span class="keywordtype">None</span> )</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                 <span class="keywordflow">or</span> ( dsorf.stop_pos == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                dsorf.liftover_succeed = <span class="keyword">False</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                </div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordflow">elif</span> ( ( dsorf.spliced </div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                     <span class="keywordflow">and</span> ( dsorf.raw_splice_starts != <span class="keywordtype">None</span> )</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                     <span class="keywordflow">and</span> ( dsorf.raw_splice_starts != Constants.REPLACE_TOO_LONG_STRINGS )</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                     <span class="keywordflow">and</span> ( dsorf.splice_starts == <span class="keywordtype">None</span> ) )</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                   <span class="keywordflow">or</span> ( dsorf.spliced </div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                        <span class="keywordflow">and</span> ( dsorf.raw_splice_ends != <span class="keywordtype">None</span> )</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        <span class="keywordflow">and</span> ( dsorf.raw_splice_ends != Constants.REPLACE_TOO_LONG_STRINGS )</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        <span class="keywordflow">and</span> ( dsorf.splice_ends == <span class="keywordtype">None</span> ) ) ):</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                dsorf.liftover_succeed = <span class="keyword">False</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            </div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            updated_objects.append( dsorf )</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            </div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="comment"># Update the objects in the database</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">if</span> ( len( updated_objects ) != 0 ):</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            SQLManagerDS.get_instance().batch_insert_to_db( objects_to_insert = updated_objects,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                                            process = <span class="stringliteral">&#39;dsorfs_with_gen_len_updated&#39;</span> )</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    </div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="ae871fc781f95233d620c9f83839633cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae871fc781f95233d620c9f83839633cd">&#9670;&nbsp;</a></span>compute_gen_len()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.compute_gen_len </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>spliced</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>start_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>stop_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>splice_starts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>splice_ends</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>raw_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>compute_gen_len </h2>
<p>This is a static method that allows to compute the genomic length of an ORF using its genomic coordinates and splicing information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spliced</td><td>Boolean - Is the ORF spliced? </td></tr>
    <tr><td class="paramname">start_pos</td><td>Integer - The genomic coordinates of the start codon. </td></tr>
    <tr><td class="paramname">stop_pos</td><td>Integer - The genomic coordinates of the stop codon. </td></tr>
    <tr><td class="paramname">splice_starts</td><td>String - The genomic coordinates of the starts of the "exons". </td></tr>
    <tr><td class="paramname">splice_ends</td><td>String - The genomic coordinates of the end of the "exons". </td></tr>
    <tr><td class="paramname">raw_len</td><td>Boolean - Do the coordinates provided are the raw or converted coordinates?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>genomic_length: Integer / None - The computed genomic length of the ORF or None if it cannot be computed. </dd></dl>
<div class="fragment"><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keyword">def </span>compute_gen_len( spliced, start_pos, stop_pos, splice_starts, splice_ends, raw_len ):</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="comment"># If the start or the stop position is missing, </span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="comment"># then the genomic length cannot be computed</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <span class="keywordflow">if</span> ( ( start_pos == <span class="keywordtype">None</span> ) </div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;             <span class="keywordflow">or</span> ( stop_pos == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            genomic_length = <span class="keywordtype">None</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="comment"># Otherwise, try to compute the genomic length using</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="comment"># the available information</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordflow">if</span> raw_len:</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <span class="comment"># If the ORF is not spliced</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                <span class="comment"># or if there is no information about the splicing status of this ORF,</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                <span class="comment"># or if the splicing coordinates are missing,</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                <span class="comment"># then compute the genomic length using the start and stop coordinates.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                <span class="keywordflow">if</span> ( ( <span class="keywordflow">not</span> spliced )</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                     <span class="keywordflow">or</span> ( splice_starts == <span class="keywordtype">None</span> ) </div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                     <span class="keywordflow">or</span> ( splice_ends == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                    genomic_length = stop_pos - start_pos + 1</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                    </div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                <span class="comment"># If the splicing coordinates have been replaced by &quot;TOO_LONG&quot;, then</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                <span class="comment"># set the value of the genomic length to None</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                <span class="keywordflow">elif</span> ( splice_starts == Constants.REPLACE_TOO_LONG_STRINGS ):</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                    genomic_length = <span class="keywordtype">None</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                </div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                <span class="comment"># Otherwise, compute the length of each &quot;exon&quot; and sum them to get the genomic length</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    sp_starts = map( int, </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                     splice_starts.split( Constants.ORF_SPLICING_COORD_SEPARATOR ) )</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                    sp_ends = map( int, </div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                   splice_ends.split( Constants.ORF_SPLICING_COORD_SEPARATOR ) )</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    </div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                    exon_lengths = []</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                    <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range( len( sp_starts ) ):</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                        exon_lengths.append( abs( sp_ends[ k ] - sp_starts[ k ] ) + 1 )</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                        </div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                    genomic_length = sum( exon_lengths )</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                    </div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                <span class="comment"># If the ORF is not spliced </span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> spliced ):</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                    genomic_length = stop_pos - start_pos + 1</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                </div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    <span class="comment"># Otherwise, if the splicing coordinates are missing,</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    <span class="comment"># then set the value of the genomic length to None</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                    <span class="keywordflow">if</span> ( ( splice_starts == <span class="keywordtype">None</span> ) </div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                         <span class="keywordflow">or</span> ( splice_ends == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                        genomic_length = <span class="keywordtype">None</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                </div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                    <span class="comment"># Otherwise, compute the length of each &quot;exon&quot; and sum them to get the genomic length</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                    <span class="keywordflow">else</span>:</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                        sp_starts = map( int, </div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                         splice_starts.split( Constants.ORF_SPLICING_COORD_SEPARATOR ) )</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                        sp_ends = map( int, </div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                                       splice_ends.split( Constants.ORF_SPLICING_COORD_SEPARATOR ) )</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                        </div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                        exon_lengths = []</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range( len( sp_starts ) ):</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                            exon_lengths.append( abs( sp_ends[ k ] - sp_starts[ k ] ) + 1 )</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                            </div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                        genomic_length = sum( exon_lengths )</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                </div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordflow">return</span> genomic_length</div></div><!-- fragment -->
</div>
</div>
<a id="af92105654885b40282c36ecd4fcbc26f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92105654885b40282c36ecd4fcbc26f">&#9670;&nbsp;</a></span>convert_coord()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.convert_coord </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>strand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>convert_coord </h2>
<p>This method returns the genomics coordinates (chromosome, strand and position) after its conversion from an anotation version to an other.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chr</td><td>String - The chromosome name. </td></tr>
    <tr><td class="paramname">strand</td><td>String - The genomic strand. </td></tr>
    <tr><td class="paramname">position</td><td>Integer - The position to convert. </td></tr>
    <tr><td class="paramname">lo</td><td>LiftOver - The LiftOver instance (pyliftover package) necessary to perform the conversion of the genomic coordinates.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>new_chr: String - The chromosome name after the conversion. </dd>
<dd>
new_strand: String - The genomic strand after the conversion. </dd>
<dd>
new_pos: The position after the conversion.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">ConvertCoordException</td><td>When the conversion of the genomic coordinate failed. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">def </span>convert_coord( chr, strand, position, lo ):</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment"># Check all the necessary information are provided</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> ( ( chr == <span class="keywordtype">None</span> ) <span class="keywordflow">or</span> ( strand == <span class="keywordtype">None</span> ) <span class="keywordflow">or</span> ( position == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">raise</span> ConvertCoordException( <span class="stringliteral">&#39;The conversion of the genomic coordinates (&#39;</span> +</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                         str( chr ) + str( strand ) + <span class="stringliteral">&#39;:&#39;</span> + str( position ) + </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                         <span class="stringliteral">&#39;) failed as some necessary data are missing.&#39;</span> )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        </div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment"># Make sure the chromosome name contains the &#39;chr&#39; prefix</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        chr = str( chr )</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> chr.startswith( <span class="stringliteral">&#39;chr&#39;</span> ) ):</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            chr = <span class="stringliteral">&#39;chr&#39;</span> + chr</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment"># Try to convert the provided coordinates</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        new_coord = lo.convert_coordinate( chr,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                           int( position ),</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                           strand )</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> ( ( new_coord != <span class="keywordtype">None</span> ) <span class="keywordflow">and</span> ( len( new_coord ) == 1 ) ):</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            new_chr = new_coord[0][0]</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            new_pos = new_coord[0][1]</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            new_strand = new_coord[0][2]</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">return</span> ( new_chr, new_strand, new_pos )</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">raise</span> ConvertCoordException( <span class="stringliteral">&#39;The conversion of the genomic coordinates (&#39;</span> +</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                         str( chr ) + str( strand ) + <span class="stringliteral">&#39;:&#39;</span> + str( position ) + </div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                         <span class="stringliteral">&#39;) failed.&#39;</span> )</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                </div></div><!-- fragment -->
</div>
</div>
<a id="af278e4c4a9e4e1e631401173b4f1db0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af278e4c4a9e4e1e631401173b4f1db0a">&#9670;&nbsp;</a></span>convert_dsorf_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.convert_dsorf_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dsorf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>convert_dsorf_coordinates </h2>
<p>This is a static method that allows to convert all the genomic coordinates of a DSORF entry. It tries to convert:</p><ul>
<li>raw_strand (output registered in strand).</li>
<li>raw_start_pos (output registered in start_pos).</li>
<li>raw_stop_pos (output registered in stop_pos).</li>
<li>raw_splice_starts (output registered in splice_starts).</li>
<li>raw_splice_stops (output registered in splice_stops).</li>
</ul>
<p>If the conversion cannot be performed, then a warning is logged and the value of the attribute is set to None. If the chromosome of one attribute changed during the conversion, then a message is logged, the conversion is stopped for the entry and all the attributes that were going to be converted are re-set to None.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsorf</td><td>DSORF - The DSORF entry for which the conversion should be performed. </td></tr>
    <tr><td class="paramname">lo</td><td>LiftOver - The LiftOver instance (pyliftover package) necessary to perform the conversion of the genomic coordinates.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dsorf: DSORF - The updated DSORF object. </dd></dl>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">def </span>convert_dsorf_coordinates( dsorf, lo ):</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment"># Get the chromosome and the strand of the ORF</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        orf_chromosome = <span class="stringliteral">&#39;chr&#39;</span> + str( dsorf.chromosome )</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        orf_strand = dsorf.raw_strand</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        </div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment"># If the chromosome name or the strand is missing, </span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment"># then do not try to perform any conversion</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">if</span> ( ( orf_strand == <span class="keywordtype">None</span> ) <span class="keywordflow">or</span> ( orf_chromosome == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        </div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        </div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment"># Perform the conversion for the start genomic coordinate</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            ( start_chr, start_strand, start_pos ) = LiftOverStrategy.convert_coord( chr = orf_chromosome,</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                                                     strand = orf_strand,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                                                                     position = dsorf.raw_start_pos,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                                                                     lo = lo )</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of start coordinate for the&#39;</span> +</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                           <span class="stringliteral">&#39; DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + <span class="stringliteral">&#39;&quot;. &#39;</span> + e.get_message() + </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                           <span class="stringliteral">&#39; Hence this position will not be registered.&#39;</span> +</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                           <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            ( start_chr, start_strand, start_pos ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            </div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <span class="comment"># Check the chromosome name did not changed during coordinates conversion, </span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="comment"># otherwise log an error message</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordflow">if</span> ( orf_chromosome != start_chr ):</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <span class="keywordflow">if</span> ( start_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == orf_chromosome ):</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF with ID &quot;&#39;</span> +</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                                   str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned a start position on a&#39;</span> +</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                   <span class="stringliteral">&#39; different chromosome (ORF chromosome: &quot;&#39;</span> + orf_chromosome + </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                                   <span class="stringliteral">&#39;&quot;, start chromosome: &quot;&#39;</span> + str( start_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> +</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                                   <span class="stringliteral">&#39; but these chromosomes actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                                   <span class="stringliteral">&#39; Hence, this DSORF will be considered as located on &quot;&#39;</span> + </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                                   orf_chromosome + <span class="stringliteral">&#39;&quot;.&#39;</span> +</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                   <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                                 str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned a start position on a&#39;</span> +</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                                 <span class="stringliteral">&#39; different chromosome (ORF chromosome: &quot;&#39;</span> + orf_chromosome + </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, start chromosome: &quot;&#39;</span> + str( start_chr ) + <span class="stringliteral">&#39;&quot;).&#39;</span> +</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the lift over will not be performed for this ORF.&#39;</span> +</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment"># Perform the conversion for the stop genomic coordinate</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            ( stop_chr, stop_strand, stop_pos ) = LiftOverStrategy.convert_coord( chr = orf_chromosome,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                                                                  strand = orf_strand,</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                                                                  position = dsorf.raw_stop_pos,</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                                                                  lo = lo )</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            </div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of stop coordinate for the DSORF&#39;</span> +</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                           <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dsorf.id ) + <span class="stringliteral">&#39;&quot;. &#39;</span> + e.get_message() + </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                           <span class="stringliteral">&#39; Hence this position will not be registered.&#39;</span> +</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                           <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            ( stop_chr, stop_strand, stop_pos ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="comment"># Check the chromosome name did not changed during coordinates conversion,</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="comment"># otherwise log an error message and reset the DSORF entry</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordflow">if</span> ( orf_chromosome != stop_chr ):</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">if</span> ( stop_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == orf_chromosome ):</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                                   str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned a stop position on a&#39;</span> +</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                                   <span class="stringliteral">&#39; different chromosome (ORF chromosome: &quot;&#39;</span> + orf_chromosome + </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                                   <span class="stringliteral">&#39;&quot;, stop chromosome: &quot;&#39;</span> + str( stop_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> +</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                                   <span class="stringliteral">&#39; but these chromosomes actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                                   <span class="stringliteral">&#39; Hence, this DSORF will be considered as located on &quot;&#39;</span> + </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                   orf_chromosome + <span class="stringliteral">&#39;&quot;.&#39;</span> +</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                                   <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                                 str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned a stop position on a&#39;</span> +</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                                 <span class="stringliteral">&#39; different chromosome (ORF chromosome: &quot;&#39;</span> + orf_chromosome + </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, stop chromosome: &quot;&#39;</span> + str( stop_chr ) + <span class="stringliteral">&#39;&quot;).&#39;</span> +</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the LiftOver will not be performed for this ORF.&#39;</span> +</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment"># Check the agreement between the start and stop coordinates after conversion:</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment"># - check the strand after conversion</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">#     - If the strands of the start and stop positions are both missing,</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="comment">#       then stop the conversion and return the dsorf (without saving any </span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">#       of the converted position).</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">#     - Otherwise</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">#         - If the start strand is missing or if the stop strand is missing, </span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">#           then, one checks that the provided strand is the same as the raw strand.</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="comment">#         - If the both strands are provided,</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">#             - and if they are different one from the other, then stop the conversion, </span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">#               log an error and return the dsorf (without saving any of the converted </span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">#               position)</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">#             - and if they are equals, then check if they equal also the raw strand.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">#</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment"># - If the strand is on the opposite strand than the raw strand, then exchange the start </span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">#   and stop coordinates in order to always get the start lower than the stop.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">#</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span> ( ( start_strand, stop_strand ) == ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            reverse_start_stop = <span class="keyword">False</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">if</span> ( start_strand == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                dsorf.strand = stop_strand</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordflow">if</span> ( stop_strand != orf_strand ):</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    reverse_start_stop = <span class="keyword">True</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">elif</span> ( stop_strand == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                dsorf.strand = start_strand</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> ( start_strand != orf_strand ):</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    reverse_start_stop = <span class="keyword">True</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">if</span> ( start_strand != stop_strand ):</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                 str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned a start and a stop position&#39;</span> +</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                 <span class="stringliteral">&#39; on different strands (orf strand: &quot;&#39;</span> + str( orf_strand ) + </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, start strand: &quot;&#39;</span> + str( start_strand ) + </div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, stop strand: &#39;</span> + str( stop_strand ) + </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                                 <span class="stringliteral">&#39;&quot;). Hence the converted coordinates of this DSORF will&#39;</span> +</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                                 <span class="stringliteral">&#39; not be registered.&#39;</span> +</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_STRAND + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    dsorf.strand = start_strand</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <span class="keywordflow">if</span> ( start_strand != orf_strand ):</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        reverse_start_stop = <span class="keyword">True</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment"># Save the new strand, start and stop positions after the conversion</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">if</span> reverse_start_stop:</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="comment"># If the strand has been reversed during the liftOver, but the position</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment"># get by conversion of the start_pos attribute (i.e. the actual &quot;new&quot; </span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="comment"># start position saved in stop_pos attribute for the DSORFs initially </span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; stop position saved in start_pos </span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="comment"># attribute for the DSORFs initially on the - strand) is lower than the </span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="comment"># position get by the conversion of the stop_pos attribute (i.e. the actual </span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="comment"># &quot;new&quot; stop position saved in start_pos attribute for the DSORFs initially </span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; start position saved in stop_pos </span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment"># attribute for the DSORFs initially on the - strand), then reset the DSORF </span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="comment"># entry.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">if</span> ( start_pos &lt; stop_pos ):</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                             str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned incoherent data: the strand&#39;</span> +</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                             <span class="stringliteral">&#39; has been reversed (new strand: &#39;</span> + str( dsorf.strand ) + </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                             <span class="stringliteral">&#39;) but the conversion of the raw_start_pos attribute provides&#39;</span> +</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                             <span class="stringliteral">&#39; a lower value than the conversion of the raw_stop_pos attribute.&#39;</span> +</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                             <span class="stringliteral">&#39; Hence, the LiftOver will not be performed for this ORF.&#39;</span> +</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_POS + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="comment"># Otherwise, inverse the value of the start and stop positions as the </span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <span class="comment"># strand has changed.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                dsorf.start_pos = stop_pos</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                dsorf.stop_pos = start_pos</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            <span class="comment"># If the strand has not been reversed during the liftOver, but the position</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment"># get by conversion of the start_pos attribute (i.e. the actual &quot;new&quot; </span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="comment"># start position saved in stop_pos attribute for the DSORFs initially </span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; stop position saved in start_pos </span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="comment"># attribute for the DSORFs initially on the - strand) is greater than the </span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="comment"># position get by the conversion of the stop_pos attribute (i.e. the actual </span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="comment"># &quot;new&quot; stop position saved in start_pos attribute for the DSORFs initially </span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; start position saved in stop_pos </span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="comment"># attribute for the DSORFs initially on the - strand), then reset the DSORF </span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="comment"># entry.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">if</span> ( start_pos &gt; stop_pos ):</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the coordinates for the DSORF with ID &quot;&#39;</span> + </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                             str( dsorf.id ) + <span class="stringliteral">&#39;&quot; returned incoherent data: the strand&#39;</span> +</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                             <span class="stringliteral">&#39; has not been reversed (strand: &#39;</span> + str( dsorf.strand ) + </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                             <span class="stringliteral">&#39;) but the conversion of the raw_start_pos attribute provides&#39;</span> +</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                             <span class="stringliteral">&#39; a higher value than the conversion of the raw_stop_pos attribute.&#39;</span> +</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                             <span class="stringliteral">&#39; Hence, the LiftOver will not be performed for this ORF.&#39;</span> +</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_POS + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                dsorf.start_pos = start_pos</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                dsorf.stop_pos = stop_pos</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                   </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.SPLICED_ATT_DSORF:</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            raw_att_value = getattr( dsorf, <span class="stringliteral">&#39;raw_&#39;</span> + att )</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            <span class="comment"># Try to convert the coordinates only if they are provided</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span> ( raw_att_value == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            <span class="comment"># If the splicing value provided in the source exceeded the longest </span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="comment"># value that can be stored, use the same &quot;TOO_LONG&quot; string</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordflow">elif</span> ( raw_att_value == Constants.REPLACE_TOO_LONG_STRINGS ):</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <span class="comment"># If splicing coordinates are provided, first parse the string into a list, </span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment"># convert each element of the list and then rebuild a string with the new coordinates</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                raw_att_value = raw_att_value.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="comment"># Try to convert each element of the list,</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <span class="comment"># If one of them cannot be converted or if one of them is not on the </span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                <span class="comment"># same strand as the start and stop positions, then the whole attribute </span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="comment"># value is set to None</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                impossible_conversion = <span class="keyword">False</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                raw_att_value_index = 0</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                new_att_value = []</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keywordflow">while</span> ( ( <span class="keywordflow">not</span> impossible_conversion ) <span class="keywordflow">and</span> ( raw_att_value_index &lt; len( raw_att_value ) ) ):</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        ( exon_chr, exon_strand, exon_pos ) = LiftOverStrategy.convert_coord( chr = orf_chromosome,</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                                                                              strand = orf_strand,</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                                                                              position = raw_att_value[ raw_att_value_index ],</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                                                                              lo = lo )</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of the &#39;</span> + att + </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                                       <span class="stringliteral">&#39; attribute for the DSORF with ID &quot;&#39;</span> + str( dsorf.id ) +</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                                       <span class="stringliteral">&#39;&quot;. &#39;</span> + e.get_message() + </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                                       <span class="stringliteral">&#39; Hence. the value of this attribute has been set to None.&#39;</span> +</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                       <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        impossible_conversion = <span class="keyword">True</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                    </div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        raw_att_value_index += 1</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        <span class="comment"># If the &quot;exon&quot; is on a different chromosome than the ORF, log a critical message</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="keywordflow">if</span> ( exon_chr != orf_chromosome ):</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            <span class="keywordflow">if</span> ( exon_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == orf_chromosome ):</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of coordinates for the&#39;</span> +</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                                               <span class="stringliteral">&#39; DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                               <span class="stringliteral">&#39;&quot; returned a splicing position on a different&#39;</span> +</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                                               <span class="stringliteral">&#39; chromosome than the ORF (ORF chromosome: &quot;&#39;</span> +</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                                               orf_chromosome + <span class="stringliteral">&#39;&quot;, splicing position on: &quot;&#39;</span> + </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                                               str( exon_chr ) + <span class="stringliteral">&#39;&quot;), but these chromosomes&#39;</span> +</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                                               <span class="stringliteral">&#39; actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                                               <span class="stringliteral">&#39; Hence, this DSORF will be considered as&#39;</span> +</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                                               <span class="stringliteral">&#39; located on &#39;</span> + orf_chromosome + <span class="stringliteral">&#39;.&#39;</span> +</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                               <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                                Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF&#39;</span> +</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                                             <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                             <span class="stringliteral">&#39;&quot; returned a splicing position on a different&#39;</span> +</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                                             <span class="stringliteral">&#39; chromosome than the ORF (ORF chromosome: &quot;&#39;</span> +</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                                             orf_chromosome + <span class="stringliteral">&#39;&quot;, splicing position on: &quot;&#39;</span> + </div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                                             str( exon_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> + <span class="stringliteral">&#39; Hence, the lift&#39;</span> +</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                                             <span class="stringliteral">&#39; over will not be performed for this DSORF.&#39;</span> +</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                        </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        <span class="comment"># If the &quot;exon&quot; is on a different strand than the ORF, </span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        <span class="comment"># then log an error and stop the conversion of coordinates</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        <span class="keywordflow">if</span> ( exon_strand != dsorf.strand ):</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSORF&#39;</span> +</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                                         <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dsorf.id ) +</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                         <span class="stringliteral">&#39;&quot; returned a splicing position on a different&#39;</span> +</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                                         <span class="stringliteral">&#39; strand than the ORF (orf strand: &quot;&#39;</span> +</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                                         str( dsorf.strand ) + <span class="stringliteral">&#39;&quot;, splicing strand: &quot;&#39;</span> + </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                                         str( exon_strand ) + <span class="stringliteral">&#39;&quot;). Hence the converted&#39;</span> +</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                         <span class="stringliteral">&#39; splicing coordinates of this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                                         <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_STRAND + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                                        ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                            impossible_conversion = <span class="keyword">True</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                            new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                            </div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                        <span class="comment"># Otherwise, add the converted position to the list </span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        <span class="comment"># and pursue the conversion</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            new_att_value.append( exon_pos )</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="comment"># Rebuild a string from the list of coordinates</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">if</span> ( ( new_att_value != <span class="keywordtype">None</span> ) <span class="keywordflow">and</span> ( len( new_att_value ) &gt; 0 ) ):</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <span class="comment"># If the converted coordinates of the &quot;exon&quot; are on the + strand</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="comment"># after the liftOver, check that all the values are in the</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="comment"># increasing order. Otherwise, reset the value of the attribute</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <span class="comment"># to None.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    <span class="keywordflow">if</span> ( dsorf.strand == <span class="stringliteral">&#39;+&#39;</span> ):</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        <span class="keywordflow">if</span> ( sorted( new_att_value ) != new_att_value ):</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                            Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates (&#39;</span> +</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                                         att + <span class="stringliteral">&#39;) for the DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                                         <span class="stringliteral">&#39;&quot; (located on + strand) returned a list of values&#39;</span> +</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                                         <span class="stringliteral">&#39; that are not in the increasing order.&#39;</span> +</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                                         <span class="stringliteral">&#39; Hence, the converted splicing coordinates of&#39;</span> +</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                                         <span class="stringliteral">&#39; this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                                         <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                         ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                            impossible_conversion = <span class="keyword">True</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                            new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                            </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="comment"># If the converted coordinates of the &quot;exon&quot; are on the - strand</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                    <span class="comment"># after the liftOver, check that all the values are in the</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="comment"># decreasing order. Otherwise, reset the value of the attribute</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="comment"># to None.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                    <span class="keywordflow">elif</span> ( dsorf.strand == <span class="stringliteral">&#39;-&#39;</span> ):</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                        <span class="keywordflow">if</span> ( sorted( new_att_value, reverse=<span class="keyword">True</span> ) != new_att_value ):</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                            Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates (&#39;</span> +</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                                         att + <span class="stringliteral">&#39;) for the DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                                         <span class="stringliteral">&#39;&quot; (located on - strand) returned a list of values&#39;</span> +</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                                                         <span class="stringliteral">&#39; that are not in the decreasing order.&#39;</span> +</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                                         <span class="stringliteral">&#39; Hence, the converted splicing coordinates of&#39;</span> +</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                                                         <span class="stringliteral">&#39; this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                                         <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                                         ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                            impossible_conversion = <span class="keyword">True</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                            new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            </div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                    <span class="comment"># If the strand of the &quot;exon&quot; after the liftOver is unknown, </span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                    <span class="comment"># make sure all the values are either in the increasing or </span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    <span class="comment"># decreasing order. Otherwise, reset the value of the attribute</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    <span class="comment"># to None.</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        <span class="keywordflow">if</span> ( ( sorted( new_att_value ) != new_att_value ) </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                             <span class="keywordflow">and</span> ( sorted( new_att_value, reverse=<span class="keyword">True</span> ) != new_att_value ) ):</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                            Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates (&#39;</span> +</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                                         att + <span class="stringliteral">&#39;) for the DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                                         <span class="stringliteral">&#39;&quot; (strand unknown) returned a list of values&#39;</span> +</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                                         <span class="stringliteral">&#39; that are neither in the increasing nor in the&#39;</span> +</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                                         <span class="stringliteral">&#39; decreasing order. Hence, the converted splicing&#39;</span> +</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                                         <span class="stringliteral">&#39; coordinates of this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                                         <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                                         ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                            impossible_conversion = <span class="keyword">True</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                            new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="comment"># Rebuild a string from the list of coordinates</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">if</span> ( ( new_att_value != <span class="keywordtype">None</span> ) <span class="keywordflow">and</span> ( len( new_att_value ) &gt; 0 ) ):</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                    </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                    new_att_value = Constants.ORF_SPLICING_COORD_SEPARATOR.join( map( str, new_att_value ) )</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    <span class="comment"># If the length of the string exceed the maximum length authorized, </span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="comment"># replace the value by None</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="keywordflow">if</span> ( len( new_att_value ) &gt; Constants.MAX_LEN_STRING ):</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                        new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment"># Register the value get after conversion</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            setattr( dsorf, att, new_att_value )</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment"># Check the coherence of the data between the splice_starts and splice_ends</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment"># when they are provided</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">if</span> ( ( dsorf.splice_starts != <span class="keywordtype">None</span> )</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;               <span class="keywordflow">and</span> ( dsorf.splice_ends != <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="comment"># If the DSORF is located on the &#39;+&#39; strand (after the liftOver), make</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="comment"># sure that each position of the start of an &quot;exon&quot; is lower that the </span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment"># position of the end of this &quot;exon&quot;, which is itself lower than the </span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="comment"># position of the start of the next &quot;exon&quot;. If this is not the case, </span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment"># delete the splicing coordinates for the DSORF entry.</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">if</span> ( dsorf.strand == <span class="stringliteral">&#39;+&#39;</span> ):</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="comment"># Get the list of splicing coordinates</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                splice_starts_list = dsorf.splice_starts.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                splice_ends_list = dsorf.splice_ends.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                </div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment"># Build the list of splicing coordinates in the &quot;logical&quot; order</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                splice_starts_ends_list = []</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range( len( splice_starts_list ) ):</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                    splice_starts_ends_list += [ splice_starts_list[ k ], splice_ends_list[ k ] ]</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                splice_starts_ends_list = map( int, splice_starts_ends_list )</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="comment"># If the splicing coordinates are not in the expected order,</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="comment"># delete them for the DSORF entry</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordflow">if</span> ( splice_starts_ends_list != sorted( splice_starts_ends_list ) ):</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates for the&#39;</span> +</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                                 <span class="stringliteral">&#39; DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                                 <span class="stringliteral">&#39;&quot; (located on + strand) returned incoherent lists of&#39;</span> +</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                                 <span class="stringliteral">&#39; splicing coordinates (not in increasing order).&#39;</span> +</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the converted splicing coordinates of&#39;</span> +</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                                 <span class="stringliteral">&#39; this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    dsorf.splice_starts = <span class="keywordtype">None</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    dsorf.splice_ends = <span class="keywordtype">None</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="comment"># If the DSORF is located on the &#39;-&#39; strand (after the liftOver), make </span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="comment">#sure that each position of the start of an &quot;exon&quot; is higher that the </span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="comment"># position of the end of this &quot;exon&quot;, which is itself higher than the </span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="comment"># position of the start of the next &quot;exon&quot;. If this is not the case, </span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="comment"># delete the splicing coordinates for the DSORF entry.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="keywordflow">elif</span> ( dsorf.strand == <span class="stringliteral">&#39;-&#39;</span> ):</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="comment"># Get the list of splicing coordinates</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                splice_starts_list = dsorf.splice_starts.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                splice_ends_list = dsorf.splice_ends.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="comment"># Build the list of splicing coordinates in the &quot;logical&quot; order</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                splice_starts_ends_list = []</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range( len( splice_starts_list ) ):</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    splice_starts_ends_list += [ splice_starts_list[ k ], splice_ends_list[ k ] ]                </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                splice_starts_ends_list = map( int, splice_starts_ends_list )</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                <span class="comment"># If the splicing coordinates are not in the expected order,</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                <span class="comment"># delete them for the DSORF entry</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="keywordflow">if</span> ( splice_starts_ends_list != sorted( splice_starts_ends_list, reverse = <span class="keyword">True</span> ) ):</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates for the&#39;</span> +</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                                 <span class="stringliteral">&#39; DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                                 <span class="stringliteral">&#39;&quot; (located on - strand) returned incoherent lists of&#39;</span> +</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                                 <span class="stringliteral">&#39; splicing coordinates (not in decreasing order).&#39;</span> +</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the converted splicing coordinates of&#39;</span> +</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                                 <span class="stringliteral">&#39; this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    dsorf.splice_starts = <span class="keywordtype">None</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    dsorf.splice_ends = <span class="keywordtype">None</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            </div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="comment"># Otherwise, if the strand of the DSORF is unknown after the liftOver, </span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="comment"># then make sure:</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="comment"># - either that each position of the start of an &quot;exon&quot; is higher that the </span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="comment">#   position of the end of this &quot;exon&quot;, which is itself higher than the </span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">#   position of the start of the next &quot;exon&quot;.</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="comment"># - or that each position of the start of an &quot;exon&quot; is higher that the </span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="comment">#   position of the end of this &quot;exon&quot;, which is itself higher than the </span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="comment">#   position of the start of the next &quot;exon&quot;.</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="comment"># If this is not the case, delete the splicing coordinates for the DSORF entry.</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="comment"># Get the list of splicing coordinates</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                splice_starts_list = dsorf.splice_starts.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                splice_ends_list = dsorf.splice_ends.split( Constants.ORF_SPLICING_COORD_SEPARATOR )</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                </div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <span class="comment"># Build the list of splicing coordinates in the &quot;logical&quot; order                </span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                splice_starts_ends_list = []</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">for</span> k <span class="keywordflow">in</span> range( len( splice_starts_list ) ):</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    splice_starts_ends_list += [ splice_starts_list[ k ], splice_ends_list[ k ] ]</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                splice_starts_ends_list = map( int, splice_starts_ends_list )</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="comment"># If the splicing coordinates are not in the expected order,</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="comment"># delete them for the DSORF entry</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                <span class="keywordflow">if</span> ( ( splice_starts_ends_list != sorted( splice_starts_ends_list ) ) </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                     <span class="keywordflow">and</span> ( splice_starts_ends_list != sorted( splice_starts_ends_list, reverse = <span class="keyword">True</span> ) ) ):</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the splicing coordinates for the&#39;</span> +</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                 <span class="stringliteral">&#39; DSORF with ID &quot;&#39;</span> + str( dsorf.id ) + </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                 <span class="stringliteral">&#39;&quot; (strand after LiftOver unknown) returned incoherent&#39;</span> +</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                                 <span class="stringliteral">&#39; lists of splicing coordinates (neither in increasing&#39;</span> +</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                                 <span class="stringliteral">&#39; nor in decreasing order). Hence, the converted splicing&#39;</span> +</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                                 <span class="stringliteral">&#39; coordinates of this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_SPLCOORD + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    dsorf.splice_starts = <span class="keywordtype">None</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    dsorf.splice_ends = <span class="keywordtype">None</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    </div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">elif</span> ( ( dsorf.splice_starts == <span class="keywordtype">None</span> )</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;               <span class="keywordflow">or</span> ( dsorf.splice_ends == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            dsorf.splice_starts = <span class="keywordtype">None</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            dsorf.splice_ends = <span class="keywordtype">None</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">return</span> dsorf</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        </div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                </div></div><!-- fragment -->
</div>
</div>
<a id="ac7040512fdc03b128eaffa69be93e718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7040512fdc03b128eaffa69be93e718">&#9670;&nbsp;</a></span>convert_dstranscript_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.convert_dstranscript_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dstranscript</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>lo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>convert_dstranscript_coordinates </h2>
<p>This is a static method that allows to convert all the genomic coordinates of a DSTranscript entry. It tries to convert:</p><ul>
<li>raw_strand (output registered in strand).</li>
<li>raw_start_pos (output registered in start_pos).</li>
<li>raw_end_pos (output registered in end_pos).</li>
<li>raw_cds_start_pos (output registered in cds_start_pos).</li>
<li>raw_cds_stop_pos (output registered in cds_stop_pos).</li>
</ul>
<p>If the conversion cannot be performed a warning is logged and the value of the attribute is set to None. If the chromosome of one attribute changed during the conversion, then a message is logged, the conversion is stopped for the entry and all the attributes that were going to be converted are re-set to None.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dstranscript</td><td>DSTranscript - The DSTranscript entry for which the conversion should be performed. </td></tr>
    <tr><td class="paramname">lo</td><td>LiftOver - The LiftOver instance (pyliftover package) necessary to perform the conversion of the genomic coordinates.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dstranscript: DSTranscript - The updated DSTranscript object. </dd></dl>
<div class="fragment"><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">def </span>convert_dstranscript_coordinates( dstranscript, lo ):</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="comment"># Get the strand of the transcript</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        transcript_strand = dstranscript.raw_strand</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="comment"># Get the chromosome of the gene related to this transcript</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        transcript_gene = SQLManagerDS.get_instance().get_session().query( Gene ).filter( Gene.gene_id == dstranscript.gene_id ).one()</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">if</span> ( transcript_gene.chromosome == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            transcript_chromosome = <span class="keywordtype">None</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            transcript_chromosome = <span class="stringliteral">&#39;chr&#39;</span> + transcript_gene.chromosome</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        </div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="comment"># If the chromosome name or the strand is missing, </span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="comment"># do not try to perform any conversion </span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">if</span> ( ( transcript_strand == <span class="keywordtype">None</span> ) <span class="keywordflow">or</span> ( transcript_chromosome == <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            </div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        </div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="comment"># Perform the conversion for the start genomic coordinate</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            ( start_chr, start_strand, start_pos ) = LiftOverStrategy.convert_coord( chr = transcript_chromosome, </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                                                                                     strand = transcript_strand, </div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                                                                                     position = dstranscript.raw_start_pos, </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                                                                     lo = lo )</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        </div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of start coordinate for the&#39;</span> +</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                           <span class="stringliteral">&#39; DSTranscript with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot;. &#39;</span> + </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                                           e.get_message() + <span class="stringliteral">&#39; Hence this position will not be registered.&#39;</span> +</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                           <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            ( start_chr, start_strand, start_pos ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            </div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="comment"># Make sure the chromosome name did not changed during coordinates conversion</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordflow">if</span> ( transcript_chromosome != start_chr ):</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <span class="keywordflow">if</span> ( start_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == transcript_chromosome ):</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                    Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of coordinates for the DStranscript&#39;</span> +</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                                   <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned a&#39;</span> +</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                                   <span class="stringliteral">&#39; start position on a different chromosome&#39;</span> +</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                                   <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                                   <span class="stringliteral">&#39;&quot;, start chromosome: &quot;&#39;</span> + str( start_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> +</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                                   <span class="stringliteral">&#39; but these chromosomes actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                                   <span class="stringliteral">&#39; Hence, this DSTranscript will be considered as&#39;</span> +</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                                   <span class="stringliteral">&#39; located on &quot;&#39;</span> + orf_chromosome + <span class="stringliteral">&#39;&quot;.&#39;</span> +</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                                   <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                    </div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DStranscript&#39;</span> +</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                                 <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned a&#39;</span> +</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                                 <span class="stringliteral">&#39; start position on a different chromosome&#39;</span> +</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                                 <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, start chromosome: &quot;&#39;</span> + str( start_chr ) + <span class="stringliteral">&#39;&quot;).&#39;</span> +</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the lift over will not be performed for this&#39;</span> +</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                                 <span class="stringliteral">&#39; DSTranscript.&#39;</span> +</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="comment"># Perform the conversion for the end position</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            ( end_chr, end_strand, end_pos ) = LiftOverStrategy.convert_coord( chr = transcript_chromosome,</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                                                               strand = transcript_strand,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                                               position = dstranscript.raw_end_pos,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                                                                               lo = lo )</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of end coordinate for the DSTranscript&#39;</span> +</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                                           <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot;. &#39;</span> + e.get_message() + </div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                                           <span class="stringliteral">&#39; Hence this position will not be registered.&#39;</span> +</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                           <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            ( end_chr, end_strand, end_pos ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            </div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="comment"># Make sure the chromosome name did not changed during coordinates conversion</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            <span class="keywordflow">if</span> ( transcript_chromosome != end_chr ):</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                <span class="keywordflow">if</span> ( end_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == transcript_chromosome ):</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                    Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of coordinates for the DStranscript&#39;</span> +</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                                   <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned an&#39;</span> +</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                                   <span class="stringliteral">&#39; end position on a different chromosome&#39;</span> +</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                                   <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                                   <span class="stringliteral">&#39;&quot;, end chromosome: &quot;&#39;</span> + str( end_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> +</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                                   <span class="stringliteral">&#39; but these chromosomes actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                                   <span class="stringliteral">&#39; Hence, this DSTranscript will be considered as&#39;</span> +</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                                   <span class="stringliteral">&#39; located on &quot;&#39;</span> + orf_chromosome + <span class="stringliteral">&#39;&quot;.&#39;</span> +</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                                                   <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    </div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DStranscript&#39;</span> +</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                                 <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned an&#39;</span> +</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                                 <span class="stringliteral">&#39; end position on a different chromosome&#39;</span> +</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                                 <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, end chromosome: &quot;&#39;</span> + str( end_chr ) + <span class="stringliteral">&#39;&quot;).&#39;</span> +</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                                 <span class="stringliteral">&#39; Hence, the lift over will not be performed for&#39;</span> +</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                                 <span class="stringliteral">&#39; this DSTranscript.&#39;</span> +</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        </div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="comment"># Check the agreement between the start and end coordinates after conversion:</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment"># - check the strand after conversion</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">#     - If the strands of the start and end positions are both missing,</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="comment">#       then end the translation and return the dsorf (without saving any </span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">#       of the converted position).</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">#     - Otherwise</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="comment">#         - If the start strand is missing or if the end strand is missing, </span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">#           then, one checks that the provided strand is the same as the raw strand.</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="comment">#         - If the both strands are provided,</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="comment">#             - and if they are different one from the other, then end the conversion, </span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="comment">#               log an error and return the dsorf (without saving any of the converted </span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">#               position)</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="comment">#             - and if they are equals, then check if they equal also the raw strand.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="comment">#</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="comment"># - If the strand is on the opposite strand than the raw strand, then exchange the start</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">#   and end coordinates in order to always get the start lower than the end.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">if</span> ( ( start_strand, end_strand ) == ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span> ) ):</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            reverse_start_end = <span class="keyword">False</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            </div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">if</span> ( start_strand == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                dstranscript.strand = end_strand</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                <span class="keywordflow">if</span> end_strand != transcript_strand:</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    reverse_start_end = <span class="keyword">True</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    </div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">elif</span> ( end_strand == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                dstranscript.strand = start_strand</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keywordflow">if</span> start_strand != transcript_strand:</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    reverse_start_end = <span class="keyword">True</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                <span class="keywordflow">if</span> ( start_strand != end_strand ):</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of coordinates for the DSTranscript&#39;</span> +</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                                 <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned a&#39;</span> +</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                                 <span class="stringliteral">&#39; start and an end position on different strands&#39;</span> +</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                                 <span class="stringliteral">&#39; (DSTranscript strand: &quot;&#39;</span> + str( transcript_strand ) + </div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                                 <span class="stringliteral">&#39;&quot;, start strand: &quot;&#39;</span> + str( start_strand ) + <span class="stringliteral">&#39;&quot;, end strand: &quot;&#39;</span> + </div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                                 str( end_strand ) + <span class="stringliteral">&#39;&quot;). Hence the converted coordinates&#39;</span> +</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                                 <span class="stringliteral">&#39; of this DSORF will not be registered.&#39;</span> +</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                                 <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_STRAND + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                                 ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                    </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                    <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    dstranscript.strand = start_strand</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    <span class="keywordflow">if</span> ( start_strand != transcript_strand ):</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                        reverse_start_stop = <span class="keyword">True</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                                </div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment"># Save the new strand, start, end positions after the conversion</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">if</span> reverse_start_end:                    </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="comment"># If the strand has been reversed during the liftOver, but the position</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="comment"># get by conversion of the start_pos attribute (i.e. the actual &quot;new&quot; </span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <span class="comment"># start position saved in end_pos attribute for the DSTranscripts initially </span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; end position saved in start_pos </span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="comment"># attribute for the DSTranscripts initially on the - strand) is lower than </span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="comment"># the position get by the conversion of the end_pos attribute (i.e. the actual </span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="comment"># &quot;new&quot; end position saved in start_pos attribute for the DSTranscripts </span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="comment"># initially on the + strand, and the actual &quot;new&quot; start position saved in </span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment"># end_pos attribute for the DSTranscripts initially on the - strand), </span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="comment"># then reset the DSTranscript entry.</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">if</span> ( start_pos &lt; end_pos ):</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the coordinates for the DSTranscript&#39;</span> +</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                                             <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned incoherent&#39;</span> +</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                             <span class="stringliteral">&#39; data: the strand has been reversed (new strand: &#39;</span> + </div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                             str( dstranscript.strand ) + <span class="stringliteral">&#39;) but the conversion of the&#39;</span> +</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                             <span class="stringliteral">&#39; raw_start_pos attribute provides a lower value than the&#39;</span> +</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                             <span class="stringliteral">&#39; conversion of the raw_end_pos attribute.&#39;</span> +</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                             <span class="stringliteral">&#39; Hence, the LiftOver will not be performed for this DSTranscript.&#39;</span> +</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_POS + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="comment"># Otherwise, inverse the value of the start and stop </span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="comment"># positions as the strand has changed.</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                dstranscript.start_pos = end_pos</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                dstranscript.end_pos = start_pos</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                </div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            <span class="comment"># If the strand has not been reversed during the liftOver, but the position</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="comment"># get by conversion of the start_pos attribute (i.e. the actual &quot;new&quot; </span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="comment"># start position saved in end_pos attribute for the DSTranscripts initially </span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="comment"># on the + strand, and the actual &quot;new&quot; end position saved in start_pos </span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            <span class="comment"># attribute for the DSTranscripts initially on the - strand) is greater than </span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="comment"># the position get by the conversion of the end_pos attribute (i.e. the actual </span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <span class="comment"># &quot;new&quot; end position saved in start_pos attribute for the DSTranscripts </span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="comment"># initially on the + strand, and the actual &quot;new&quot; start position saved in </span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            <span class="comment"># end_pos attribute for the DSTranscripts initially on the - strand), </span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            <span class="comment"># then reset the DSTranscript entry.</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">if</span> start_pos &gt; stop_pos:</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the coordinates for the DSTranscript&#39;</span> +</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                             <span class="stringliteral">&#39; with ID &quot;&#39;</span> + str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned incoherent&#39;</span> +</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                             <span class="stringliteral">&#39; data: the strand has not been reversed (strand: &#39;</span> + </div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                             str( dstranscript.strand ) + <span class="stringliteral">&#39;) but the conversion of the&#39;</span> +</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                             <span class="stringliteral">&#39; raw_start_pos attribute provides a higher value than the&#39;</span> +</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                             <span class="stringliteral">&#39; conversion of the raw_end_pos attribute.&#39;</span> +</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                             <span class="stringliteral">&#39; Hence, the LiftOver will not be performed for this DSTranscript.&#39;</span> +</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_POS + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keywordflow">return</span> LiftOverStrategy.reset_dsorf( dsorf )</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                dstranscript.start_pos = start_pos</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                dstranscript.end_pos = end_pos</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        </div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        </div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        </div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.CDS_ATT_DSTRANSCRIPT:</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            </div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            raw_att_value = getattr( dstranscript, <span class="stringliteral">&#39;raw_&#39;</span> + att )</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            </div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="comment"># Try to convert the coordinates only if they are provided</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            <span class="keywordflow">if</span> ( raw_att_value == <span class="keywordtype">None</span> ):</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                new_att_value = <span class="keywordtype">None</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                    ( new_chr, new_strand, new_att_value ) = LiftOverStrategy.convert_coord( chr = transcript_chromosome, </div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                                                                             strand = transcript_strand, </div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                                                                             position = raw_att_value, </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                                                                             lo = lo )</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                    </div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="keywordflow">except</span> ConvertCoordException <span class="keyword">as</span> e:</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    Logger.get_instance().warning( <span class="stringliteral">&#39;Error during conversion of the &#39;</span> + att + </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                                   <span class="stringliteral">&#39; attribute for the DSTranscript with ID &quot;&#39;</span> + </div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                                   str( dstranscript.id ) + <span class="stringliteral">&#39;&quot;. &#39;</span> + e.get_message() + </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                                   <span class="stringliteral">&#39; Hence. the value of this attribute has been set to None.&#39;</span> +</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                                   <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_FAIL + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    ( new_chr, new_strand, new_att_value ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    </div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    <span class="comment"># Check the agreement with the start and end coordinates after conversion</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    <span class="comment"># If the CDS is on a different chromosome than the transcript, </span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                    <span class="comment"># log an error message and stop the conversion</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    <span class="keywordflow">if</span> ( new_chr != transcript_chromosome ):</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        <span class="keywordflow">if</span> ( new_chr.split( <span class="stringliteral">&#39;_&#39;</span> )[ 0 ] == transcript_chromosome ):</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                            Logger.get_instance().warning( <span class="stringliteral">&#39;The conversion of the &#39;</span> + att + </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                                           <span class="stringliteral">&#39; attribute for the DSTranscript with ID &quot;&#39;</span> + </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                                           str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned a position&#39;</span> +</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                                           <span class="stringliteral">&#39; on a different chromosome than the transcript&#39;</span> +</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                                           <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                                                           <span class="stringliteral">&#39;&quot;, attribute chromosome: &#39;</span> + str( new_chr ) + <span class="stringliteral">&#39;&quot;),&#39;</span> + </div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                                           <span class="stringliteral">&#39; but these chromosomes actually seem to be the same.&#39;</span> +</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                                           <span class="stringliteral">&#39; Hence, this DSTranscript will be considered&#39;</span> +</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                                           <span class="stringliteral">&#39; as located on &quot;&#39;</span> + orf_chromosome + <span class="stringliteral">&#39;&quot;.&#39;</span> +</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                                           <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_DIFFCHR + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                            </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                            Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the &#39;</span> + att + </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                                         <span class="stringliteral">&#39; attribute for the DSTranscript with ID &quot;&#39;</span> + </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                                         str( dstranscript.id ) + <span class="stringliteral">&#39;&quot; returned a position&#39;</span> +</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                                         <span class="stringliteral">&#39; on a different chromosome than the transcript&#39;</span> +</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                                         <span class="stringliteral">&#39; (Transcript chromosome: &quot;&#39;</span> + transcript_chromosome + </div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                                         <span class="stringliteral">&#39;&quot;, end chromosome: &quot;&#39;</span> + str( end_chr ) + <span class="stringliteral">&#39;&quot;).&#39;</span> +</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                                         <span class="stringliteral">&#39; Hence, the lift over will not be performed for&#39;</span> +</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                                         <span class="stringliteral">&#39; this DSTranscript.&#39;</span> +</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                                         <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_CHR + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                                         ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                            <span class="keywordflow">return</span> LiftOverStrategy.reset_dstranscript( dstranscript )</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        </div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    <span class="comment"># If the CDS is on the other strand, log an error and do not register the coordinates</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                    <span class="keywordflow">if</span> ( new_strand != transcript_strand ):</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                        Logger.get_instance().error( <span class="stringliteral">&#39;The conversion of the &#39;</span> + att + <span class="stringliteral">&#39; attribute for the&#39;</span> +</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                                     <span class="stringliteral">&#39; DSTranscript with ID &quot;&#39;</span> + str( dstranscript.id ) +</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                                     <span class="stringliteral">&#39;&quot; returned a position on a different strand than the&#39;</span> +</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                                     <span class="stringliteral">&#39; transcript (DSTranscript strand: &quot;&#39;</span> + str( transcript_strand ) + </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                                     <span class="stringliteral">&#39;&quot;, attribute strand: &quot;&#39;</span> + str( att_strand ) + </div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                                     <span class="stringliteral">&#39;&quot;). Hence the converted coordinates of this&#39;</span> +</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                                     <span class="stringliteral">&#39; DSTranscript will not be registered.&#39;</span> +</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                                     <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_LIFTOV_CONFL_STRAND + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                                     ex = <span class="keyword">False</span> )</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                        ( new_chr, new_strand, new_att_value ) = ( <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span> )</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                        </div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="comment"># Register the value get after conversion</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            setattr( dstranscript, att, new_att_value )</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="comment"># If the strand of the transcript changed during the conversion, reverse the CDS positions</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">if</span> reverse_start_stop:</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            ( dstranscript.cds_start_pos, dstranscript.cds_stop_pos ) = ( dstranscript.cds_stop_pos, dstranscript.cds_start_pos )</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            </div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">return</span> dstranscript</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                </div></div><!-- fragment -->
</div>
</div>
<a id="ac5abc0e6b46bc71833c0ed2a43b37a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5abc0e6b46bc71833c0ed2a43b37a50">&#9670;&nbsp;</a></span>convert_genomic_coordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.convert_genomic_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>convert_genomic_coordinates </h2>
<p>This method allows to convert all the genomic coordinates contained in the DSORF and DSTranscript table of the DS database to the current version.</p>
<p>The entries of these tables are updated during the execution of this method:</p><ul>
<li>DSORF table: start_pos, stop_pos, splice_starts, splice_stops attributes</li>
<li>DSTranscript table: start_pos, end_pos, cds_start_pos, cds_stop_pos NB: When the coordinates provided by the source (attributes with a 'raw_' prefix) are already in the right annotation version, they are just copied into the corresponding field (attribute without 'raw_' prefix). Otherwise, the coordinates are converted (using pyliftover) and saved in the corresponding field.</li>
</ul>
<p>/!\ Please be aware that this version of the method uses GRCh38 (hg38) and GRCm38 (mm10) as current annotation versions, and only allows the conversion of GRCh37 (hg19) coordinates to GRCh38 (hg38), as all the file parsed provide coordinates either in the GRCh38 (hg38), GRCh37 (hg19) or GRCm38 (mm10) annotation version. See the Constants file for more information about the annotation version handled by the program. </p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keyword">def </span>convert_genomic_coordinates( self ):</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="comment"># Get all the data sources contained in the database</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        datasources = DataManager.get_instance().get_data( Constants.DM_ALL_DATASOURCES )</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        </div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment"># Get the dictionary which associates each data source </span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment"># to its annotation version</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        datasource_annot = DataManager.get_instance().get_data( Constants.DM_DATASOURCE_ANNOT )</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment"># Instantiate an empty list to receive all the objects </span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment"># that have to be updated</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        updated_objects = []</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="comment"># Get the total number of entries expected to be treated and </span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment"># reset the ProgressionBar instance to follow the progression</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        total_entries_count = ( SQLManagerDS.get_instance().get_session().query( DSORF ).count() + </div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                SQLManagerDS.get_instance().get_session().query( DSTranscript ).count() )</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        ProgressionBar.get_instance().reset_instance( total = total_entries_count )</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment"># Get the list of the current annotation version for the species</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        current_annotation = [ Constants.CURRENT_NCBI_ANNOTATION[ self.species ], </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                               Constants.CURRENT_UCSC_ANNOTATION[ self.species ] ]</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="comment"># For each data source, perform the conversion of coordinates </span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment"># on each DSORF and DSTranscript entry related to it</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">for</span> ( ds, annot ) <span class="keywordflow">in</span> datasource_annot.items():</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            Logger.get_instance().debug( <span class="stringliteral">&#39;LiftOverStrategy.convert_genomic_coordinates():&#39;</span> +</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                         <span class="stringliteral">&#39; Starting the conversion of the genomic coordinates of&#39;</span> +</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                         <span class="stringliteral">&#39; DSORF and DSTranscript entries related to &#39;</span> + </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                         ds + <span class="stringliteral">&#39; (annotation version: &#39;</span> + annot + <span class="stringliteral">&#39;).&#39;</span> )</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="comment"># Get all the DSORF entries and all the DSTranscript entries related to this source</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            all_dsorfs_for_source = SQLManagerDS.get_instance().get_session().query( DSORF ).filter( DSORF.data_source == ds ).all()</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            all_dstranscripts_for_source = SQLManagerDS.get_instance().get_session().query( DSTranscript ).filter( DSTranscript.data_source == ds ).all()</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment"># If the annotation of the data source is the current one, </span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment"># duplicate the provided genomic coordinates</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> annot <span class="keywordflow">in</span> current_annotation:</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="comment"># Treat all the DSORF entries related to the source</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">for</span> dsorf <span class="keywordflow">in</span> all_dsorfs_for_source:</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <span class="comment"># Duplicate the genomic coordinates</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    updated_objects.append( self.duplicate_dsorf_coordinates( dsorf ) )</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                </div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <span class="comment"># Treat all the DSTranscript entries related to the source</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">for</span> dstranscript <span class="keywordflow">in</span> all_dstranscripts_for_source:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    </div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <span class="comment"># Duplicate the genomic coordinates</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    updated_objects.append( self.duplicate_dstranscript_coordinates( dstranscript ) )</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    </div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment"># Otherwise, first make sure the annotation of the data source is one expected</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">elif</span> annot <span class="keywordflow">in</span> Constants.ALL_SPECIES_ANNOTATIONS:</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="comment"># Download and import the appropriate chain file (from the UCSC) </span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="comment"># allowing the conversion of annotation version</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                Logger.get_instance().debug( <span class="stringliteral">&#39;LiftOverStrategy.convert_genomic_coordinates():&#39;</span> +</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                             <span class="stringliteral">&#39; Downloading the appropriate chain file from the UCSC&#39;</span> +</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                             <span class="stringliteral">&#39; to perfom the conversion of the genomic coordinates.&#39;</span> )</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                chain_file_url = LiftOverStrategy.CHAIN_FILE_URL[ annot ]</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> os.path.exists( DefaultTemporaryFolder.TEMPORARY_FOLDER ) ):</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    os.makedirs( DefaultTemporaryFolder.TEMPORARY_FOLDER )</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                </div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                chain_file_path = os.path.join( DefaultTemporaryFolder.TEMPORARY_FOLDER, LiftOverStrategy.CHAIN_FILENAMES[ annot ] )</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                </div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> os.path.exists( chain_file_path ) ):</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    wget.download( chain_file_url, out = chain_file_path, bar = <span class="keywordtype">None</span> )</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                lo = pylo.LiftOver( chain_file_path )</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="comment"># Treat all the DSORF entries related to the source</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keywordflow">for</span> dsorf <span class="keywordflow">in</span> all_dsorfs_for_source:</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    <span class="comment"># Convert the genomic coordinates</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    updated_objects.append( self.convert_dsorf_coordinates( dsorf, lo ) )</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    </div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="comment"># Treat all the DSTranscript entries related to the source</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordflow">for</span> dstranscript <span class="keywordflow">in</span> all_dstranscripts_for_source:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <span class="comment"># Convert the genomic coordinates</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    updated_objects.append( self.convert_dstranscript_coordinates( dstranscript, lo ) )</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="comment"># Otherwise, log an error</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                Logger.get_instance.error( <span class="stringliteral">&#39;LiftOverStrategy.convert_genomic_coordinates():&#39;</span> +</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                           <span class="stringliteral">&#39; The annotation version provided for the data source &#39;</span> +</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                           ds + <span class="stringliteral">&#39;(&#39;</span> + annot + <span class="stringliteral">&#39;) is unexpected.&#39;</span> + </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                           <span class="stringliteral">&#39; Hence, the genomic coordinates of the entries related to&#39;</span> +</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                           <span class="stringliteral">&#39; this data source will not be converted.&#39;</span> +</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                           <span class="stringliteral">&#39; Please make sure to use one of the following annotation version: &#39;</span> + </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                           <span class="stringliteral">&#39;, &#39;</span>.join( Constants.ALL_SPECIES_ANNOTATIONS ) + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                           ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            Logger.get_instance().debug( <span class="stringliteral">&#39;LiftOverStrategy.convert_genomic_coordinates():&#39;</span> +</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                         <span class="stringliteral">&#39; The conversion of genomic coordinates of the&#39;</span> +</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                         <span class="stringliteral">&#39; DSORF and DSTranscript entries related to &#39;</span> + </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                         ds + <span class="stringliteral">&#39; has finished.&#39;</span> )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment"># Update the objects in the database</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">if</span> ( len( updated_objects ) != 0 ):</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            SQLManagerDS.get_instance().batch_insert_to_db( objects_to_insert = updated_objects,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                            process = <span class="stringliteral">&#39;objects_with_updated_coordinates&#39;</span> )</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a5387ffa97a5647ee14409ed06767af47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5387ffa97a5647ee14409ed06767af47">&#9670;&nbsp;</a></span>duplicate_dsorf_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.duplicate_dsorf_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dsorf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>duplicate_dsorf_coordinates </h2>
<p>This is a static method that allows to copy all the genomic coordinates of a DSORF entry from raw attributes to their corresponding attributes (performed when the DSORF has already been reported in the desired annotation version). It copies the value of:</p><ul>
<li>raw_start_pos in start_pos</li>
<li>raw_stop_pos in stop_pos</li>
<li>raw_splice_starts in splice_starts</li>
<li>raw_splice_stops in splice_stops</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsorf</td><td>DSORF - The DSORF entry for which the coordinates should be duplicated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dsorf: DSORF - The updated DSORF object. </dd></dl>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">def </span>duplicate_dsorf_coordinates( dsorf ):</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        dsorf.strand = dsorf.raw_strand</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.ATT_TO_CONVERT_DSORF:</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            setattr( dsorf, att, getattr( dsorf, <span class="stringliteral">&#39;raw_&#39;</span> + att ) )</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> dsorf</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a65a9326a6f986b1442a4fd78530c82c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65a9326a6f986b1442a4fd78530c82c1">&#9670;&nbsp;</a></span>duplicate_dstranscript_coordinates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.duplicate_dstranscript_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dstranscript</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>duplicate_dstranscript_coordinates </h2>
<p>This is a static method that allows to copy all the genomic coordinates of a DSTranscript entry from raw attributes to their corresponding attributes (performed when the transcript has already been reported in the desired annotation version). It copies the values of:</p><ul>
<li>raw_start_pos in start_pos</li>
<li>raw_end_pos in end_pos</li>
<li>raw_cds_start_pos in cds_start_pos</li>
<li>raw_cds_stop_pos in cds_stop_pos</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dstranscript</td><td>DSTranscript - The DSTranscript entry for which the coordinates should be duplicated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dstranscript: DSTranscript - The updated DSTranscript object. </dd></dl>
<div class="fragment"><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keyword">def </span>duplicate_dstranscript_coordinates( dstranscript ):</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.ATT_TO_CONVERT_DSTRANSCRIPT:</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            setattr( dstranscript, att, getattr( dstranscript, <span class="stringliteral">&#39;raw_&#39;</span> + att ) )</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            </div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">return</span> dstranscript</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a4f520046cb34579abe83a36ded6be151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f520046cb34579abe83a36ded6be151">&#9670;&nbsp;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.execute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>execute </h2>
<p>Execute the strategy to perfom the liftover.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When an exception has been raised during the DatabaseCheck. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>When an exception has been raised trying to update the content of the Metadata table. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">def </span>execute( self ):</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        </div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment"># Run DatabaseCheck in order to check the DS database is reachable prior to </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment"># the conversion of genomic coordinates</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Checking the database prior to the lift over...&#39;</span> )</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            DatabaseCheckStrategy().execute()</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;An error occurred whilst checking the database prior to lift over.&#39;</span> +</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                       <span class="stringliteral">&#39;\n Error code: &#39;</span> + LogCodes.ERR_DBCHECK + <span class="stringliteral">&#39;.&#39;</span>, e )</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment"># Get the species in the database</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        self.species = DataManager.get_instance().get_data( Constants.SPECIES_SHORT )</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment"># Get all the data sources contained in the database</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        DataManager.get_instance().store_DS_query_result( Constants.DM_ALL_DATASOURCES, </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                                          <span class="stringliteral">&#39;query( DataSource ).all()&#39;</span> )</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        datasources = DataManager.get_instance().get_data( Constants.DM_ALL_DATASOURCES )</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        </div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="comment"># Build a dictionary which associates each data source to its annotation version</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        DataManager.get_instance().store_data( Constants.DM_DATASOURCE_ANNOT, {} )</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        datasource_annot = DataManager.get_instance().get_data( Constants.DM_DATASOURCE_ANNOT )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">for</span> ds <span class="keywordflow">in</span> datasources.keys():</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            datasource_annot[ ds.name ] = ds.annotation_version</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment"># Save the name of the annotation currently used in the metadata table</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        metadata_all_query = SQLManagerDS.get_instance().get_session().query( Metadata ).filter( Metadata.parameter == Constants.METATABLE_CURRENT_ANNOTATION )</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        metadata_all_count = metadata_all_query.count()</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        </div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span> ( metadata_all_count == 0 ):</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            metadata_current_annot = Metadata( parameter = Constants.METATABLE_CURRENT_ANNOTATION,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                               value = Constants.CURRENT_NCBI_ANNOTATION[ self.species ],</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                               description = Constants.METATABLE_CURRENT_ANNOTATION_DESCRIPTION )</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                SQLManagerDS.get_instance().get_session().add( metadata_current_annot )</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                SQLManagerDS.get_instance().commit()</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;LiftOverStrategy.execute(): An error occurred trying to add the &#39;</span> + </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                           <span class="stringliteral">&#39; annotation version information and committing the session.&#39;</span>, e )</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            metadata_current_annot = metadata_all_query.one()</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">if</span> ( str( metadata_current_annot.value ) != Constants.CURRENT_NCBI_ANNOTATION[ self.species ] ):</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                Logger.get_instance().warning( <span class="stringliteral">&#39;An entry with parameter &#39;</span> + </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                               str( Constants.METATABLE_CURRENT_ANNOTATION ) + </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                               <span class="stringliteral">&#39; has been found in the Metadata table and&#39;</span> +</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                               <span class="stringliteral">&#39; this entry contains the value &#39;</span> + </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                               str( metadata_current_annot.value ) + </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                               <span class="stringliteral">&#39; whilst the ensembl release used by the program is &#39;</span> +</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                               str( Constants.CURRENT_NCBI_ANNOTATION[ self.species ] ) + </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                               <span class="stringliteral">&#39;. Hence, this entry will be updated to current version.&#39;</span> +</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                               <span class="stringliteral">&#39; Warning code: &#39;</span> + LogCodes.WARN_LIFTOV_META_ANNOT_UP + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                metadata_current_annot.value = Constants.CURRENT_NCBI_ANNOTATION[ self.species ]</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                metadata_current_annot.description = Constants.METATABLE_CURRENT_ANNOTATION_DESCRIPTION</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    SQLManagerDS.get_instance().commit()</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;LiftOverStrategy.execute(): An error occurred trying&#39;</span> +</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                               <span class="stringliteral">&#39; to update the Metadata entry containing the annotation&#39;</span> +</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                               <span class="stringliteral">&#39; version information.&#39;</span>, e )</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;          </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment"># Convert the genomic coordinates to the current genome assembly</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        self.convert_genomic_coordinates()</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment"># Compute the genomic lengths for all the entries of the DSORF table</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        self.compute_dsorf_gen_len()</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    </div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="accb23d55a3787303bd7396b0072cf632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb23d55a3787303bd7396b0072cf632">&#9670;&nbsp;</a></span>reset_dsorf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.reset_dsorf </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dsorf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>reset_dsorf </h2>
<p>This is a static method that allows to set all the following attributes of a DSORF entry to None:</p><ul>
<li>strand</li>
<li>start_pos</li>
<li>stop_pos</li>
<li>splice_starts</li>
<li>splice_stops</li>
</ul>
<p>This method is useful when a major error occurred during the conversion of a coordinates (in particular when the chromosome changed during the lift over), and the DSORF has to be "reset" to its initial state (prior the conversion of any coordinates).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dsorf</td><td>DSORF - The DSORF entry that needs to be "reset".</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dsorf: DSORF - The "reseted" DSORF object. </dd></dl>
<div class="fragment"><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keyword">def </span>reset_dsorf( dsorf ):</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        </div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.ATT_TO_RESET_DSORF:</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            setattr( dsorf, att, <span class="keywordtype">None</span> )</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            </div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span> dsorf</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<a id="ad552f23dae8c495d2779af294e615368"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad552f23dae8c495d2779af294e615368">&#9670;&nbsp;</a></span>reset_dstranscript()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.reset_dstranscript </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dstranscript</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>reset_dstranscript </h2>
<p>This is a static method that allows to set all the following attributes of a DSTranscript entry to None:</p><ul>
<li>strand</li>
<li>start_pos</li>
<li>end_pos</li>
<li>cds_start_pos</li>
<li>cds_end_pos</li>
</ul>
<p>This method is useful when a major error occurred during the conversion of a coordinates (in particular when the chromosome changed during the lift over), and the DSTranscript has to be "reset" to its initial state (prior the conversion of any coordinates).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dstranscript</td><td>DSTranscript - The DSTranscript entry that needs to be "reset".</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>dstranscript: DSTranscript - The "reseted" DSTranscript object. </dd></dl>
<div class="fragment"><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keyword">def </span>reset_dstranscript( dstranscript ):</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="keywordflow">for</span> att <span class="keywordflow">in</span> LiftOverStrategy.ATT_TO_RESET_DSTRANSCRIPT:</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            setattr( dstranscript, att, <span class="keywordtype">None</span> )</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            </div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">return</span> dstranscript</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        </div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        </div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8a2ffe980c764280a4bb5a029c99d93b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a2ffe980c764280a4bb5a029c99d93b">&#9670;&nbsp;</a></span>CHAIN_FILE_URL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dictionary fr.tagc.uorf.core.execution.LiftOverStrategy.LiftOverStrategy.CHAIN_FILE_URL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  { Constants.ANNOTATION_VERSION_HG19 : <span class="stringliteral">&#39;http://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/hg19ToHg38.over.chain.gz&#39;</span>,</div><div class="line">                       Constants.ANNOTATION_VERSION_GRCH37 : <span class="stringliteral">&#39;http://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/hg19ToHg38.over.chain.gz&#39;</span> }</div></div><!-- fragment --><h2>Class variables </h2>
<p>URL of chain files (necessary for the conversion of genomic positions) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/mnt/NAS7/Workspace/choteaus/tagc-uorf/project/01_ORF_datafreeze/06_src/fr/tagc/uorf/core/execution/LiftOverStrategy.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
