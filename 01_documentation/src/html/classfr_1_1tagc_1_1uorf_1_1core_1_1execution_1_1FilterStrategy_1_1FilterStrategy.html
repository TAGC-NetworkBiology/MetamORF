<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sORFdatafreezer: fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sORFdatafreezer
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>fr</b></li><li class="navelem"><b>tagc</b></li><li class="navelem"><b>uorf</b></li><li class="navelem"><b>core</b></li><li class="navelem"><b>execution</b></li><li class="navelem"><b>FilterStrategy</b></li><li class="navelem"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html">FilterStrategy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Inherits object.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aec3f263ce080d7ddbfec6378fa17517d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#aec3f263ce080d7ddbfec6378fa17517d">__init__</a> (self)</td></tr>
<tr class="separator:aec3f263ce080d7ddbfec6378fa17517d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87171f9fabc296e443a46bc108790e2c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a87171f9fabc296e443a46bc108790e2c">parse_config</a> (self)</td></tr>
<tr class="separator:a87171f9fabc296e443a46bc108790e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef9a91625d0d64e2d846e67bcb455ee"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#aeef9a91625d0d64e2d846e67bcb455ee">execute</a> (self)</td></tr>
<tr class="separator:aeef9a91625d0d64e2d846e67bcb455ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91279f2ed0a10aac548c9d0ea7209648"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a91279f2ed0a10aac548c9d0ea7209648">gene_list_filter</a> (self)</td></tr>
<tr class="separator:a91279f2ed0a10aac548c9d0ea7209648"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5943e5b4ac8c24e6378a66edc34bdb47"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a5943e5b4ac8c24e6378a66edc34bdb47">get_gene_list_queries</a> (self, gene_list)</td></tr>
<tr class="separator:a5943e5b4ac8c24e6378a66edc34bdb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b77b0b92fb04e77f79bc5e72da2da57"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a0b77b0b92fb04e77f79bc5e72da2da57">cell_context_filter</a> (self)</td></tr>
<tr class="separator:a0b77b0b92fb04e77f79bc5e72da2da57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eafb556691f2c60729015992fd5506a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a3eafb556691f2c60729015992fd5506a">get_cell_ctxt_queries</a> (self)</td></tr>
<tr class="separator:a3eafb556691f2c60729015992fd5506a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f29b7cfdea7b2fdc0c22385c600027b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a9f29b7cfdea7b2fdc0c22385c600027b">orf_categories_filter</a> (self)</td></tr>
<tr class="separator:a9f29b7cfdea7b2fdc0c22385c600027b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f2370e4312a7cce004958cc7a9a9d7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a63f2370e4312a7cce004958cc7a9a9d7">get_orf_cat_queries</a> (self)</td></tr>
<tr class="separator:a63f2370e4312a7cce004958cc7a9a9d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c1f7d5c24efe05da45c51214972b2c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#ac2c1f7d5c24efe05da45c51214972b2c">orf_annotations_filter</a> (self)</td></tr>
<tr class="separator:ac2c1f7d5c24efe05da45c51214972b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e22e8f32269847ec545e6d361db019"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a20e22e8f32269847ec545e6d361db019">get_orf_annot_queries</a> (self)</td></tr>
<tr class="separator:a20e22e8f32269847ec545e6d361db019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f0100c31b64f7ebf6509612c4a6f9d3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a1f0100c31b64f7ebf6509612c4a6f9d3">query_PRO</a> (self, classname, filter)</td></tr>
<tr class="separator:a1f0100c31b64f7ebf6509612c4a6f9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad331f970e2a01e4a38efc917a50cf4f3"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#ad331f970e2a01e4a38efc917a50cf4f3">process_queries</a> (self, queries_list)</td></tr>
<tr class="separator:ad331f970e2a01e4a38efc917a50cf4f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a037753ed8b0c301025d9c036fdd79062"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#a037753ed8b0c301025d9c036fdd79062">PRO_to_FILT</a> (self, query)</td></tr>
<tr class="separator:a037753ed8b0c301025d9c036fdd79062"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:accb921b01dd83316a6053f6ed03f622e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html#accb921b01dd83316a6053f6ed03f622e">filt_type</a></td></tr>
<tr class="separator:accb921b01dd83316a6053f6ed03f622e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html">FilterStrategy</a> </h1>
<p>This class is a strategy that aims to create a FILT database by copying all the information of the PRO database related to a provided set of genes or related to a particular cell context. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aec3f263ce080d7ddbfec6378fa17517d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3f263ce080d7ddbfec6378fa17517d">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Constructor of <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1FilterStrategy_1_1FilterStrategy.html">FilterStrategy</a> </h2>
<p>Instance variables:</p><ul>
<li>configfile: String - The path to the config file.</li>
<li>gene_list: String - The path to the gene list file.</li>
<li>cell_context: List - The list of cellular contexts on which perform the filtering.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When the config file is not provided or cannot be found at the path provided. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keyword">def </span>__init__( self ):</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        configfile = OptionManager.get_instance().get_option( OptionConstants.OPTION_CONFIG_FILE_PATH, </div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                              not_none = <span class="keyword">True</span> )</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> configfile:</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            self.configfile = configfile</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> os.path.exists( configfile ) ):</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;No config file may be found at the path provided (&#39;</span> + </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                           self.configfile + <span class="stringliteral">&#39;).&#39;</span> )</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            self.parse_config()</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;A config file has to be provided.&#39;</span> +</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                       <span class="stringliteral">&#39; Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0b77b0b92fb04e77f79bc5e72da2da57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b77b0b92fb04e77f79bc5e72da2da57">&#9670;&nbsp;</a></span>cell_context_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.cell_context_filter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>cell_context_filter </h2>
<p>This methods allows to filter the PRO database information using the provided list of cell contexts and to insert it into the FILT database. </p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keyword">def </span>cell_context_filter( self ):</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        </div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment"># Get the list of queries to use to insert data</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        queries_list = self.get_cell_ctxt_queries()</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        </div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment"># Proceed to the insertion</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        self.process_queries( queries_list )</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="aeef9a91625d0d64e2d846e67bcb455ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef9a91625d0d64e2d846e67bcb455ee">&#9670;&nbsp;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.execute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>execute </h2>
<p>Execute the strategy to complete the FILT database filtering information in the PRO database.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When the insertion of UTRNABiotypeCatalog objects fails. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">def </span>execute( self ):</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment"># Run DatabaseCheck in order to check both PRO and FILT databases are reachable and use</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment"># the appropriate models prior to the merging of data.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Checking the PRO and FILT databases prior&#39;</span> +</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                    <span class="stringliteral">&#39; to filter the PRO database...&#39;</span> )</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            DatabaseCheckStrategy().execute()</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">except</span> DenCellORFException <span class="keyword">as</span> e:</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;An error occurred whilst checking the database prior to&#39;</span> +</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                       <span class="stringliteral">&#39; compute missing information.&#39;</span> +</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                       <span class="stringliteral">&#39;\n Error code: &#39;</span> + LogCodes.ERR_DBCHECK + <span class="stringliteral">&#39;.&#39;</span>, e )</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Starting to perform the queries to copy the appropriate&#39;</span> +</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                    <span class="stringliteral">&#39; information in the FILT database...&#39;</span> )</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="comment"># Copy the content of the PROMetadata table in the FILT table</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        query_metadata = SQLManagerPRO.get_instance().get_session().query( PROMetadata )</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        self.PRO_to_FILT( query_metadata )</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        </div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment"># Filter using the gene list</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> self.gene_list:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            self.gene_list_filter()</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment"># Filter using the list of cell contexts</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">elif</span> self.cell_context:</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            self.cell_context_filter()</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment"># Filter using the list of ORF categories</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">elif</span> self.orf_categories:</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            self.orf_categories_filter()</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment"># Filter using the list of ORF annotations</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">elif</span> self.orf_annotations:</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            self.orf_annotations_filter()</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        </div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            </div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment"># Fill in the UTRNABiotypeCatalog with unique biotypes from the Transcript entries</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        all_uniq_rna_biotype = SQLManagerFILT.get_instance().get_session().query( Transcript.rna_biotype ).filter( Transcript.rna_biotype != <span class="keywordtype">None</span> ).distinct().all()</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        uniq_rna_biotype_list = GeneralUtil.query_result_to_list( all_uniq_rna_biotype )</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        </div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        objects_to_insert = []</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">for</span> rna_biotype <span class="keywordflow">in</span> uniq_rna_biotype_list:</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            utrnabiotypecatalog = UTRNABiotypeCatalog( biotype = rna_biotype )</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            objects_to_insert.append( utrnabiotypecatalog )</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            SQLManagerFILT.get_instance().batch_insert_to_db( objects_to_insert = objects_to_insert,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                                              process = <span class="stringliteral">&#39;computation of UTRNABiotypeCatalog entries&#39;</span> )</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy().execute(): An error occurred trying to insert&#39;</span> +</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                       <span class="stringliteral">&#39; the biotypes in the UTRNABiotypeCatalog table.&#39;</span>, e )        </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        SQLManagerFILT.get_instance().close_session()</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;         </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a91279f2ed0a10aac548c9d0ea7209648"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91279f2ed0a10aac548c9d0ea7209648">&#9670;&nbsp;</a></span>gene_list_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.gene_list_filter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>gene_list_filter </h2>
<p>This methods allows to get the gene list from the file and to filter the PRO database information to insert it into the FILT database.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When the format of the gene list provided is unexpected (has to be provided as 1-line or 1-column csv file). </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">def </span>gene_list_filter( self ):</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment"># Import the gene list</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        file_content = pd.read_csv( self.gene_list, </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                    sep = <span class="stringliteral">&#39;,&#39;</span>, </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                    dtype = <span class="stringliteral">&#39;str&#39;</span>, </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                    encoding = <span class="stringliteral">&#39;utf-8&#39;</span>, </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                    header = <span class="keywordtype">None</span> )</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment"># Identify if the list is provided as a line or a column and store the content in a list object</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="comment"># Get the number of rows and columns</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        nrows = file_content.shape[ 0 ]</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        ncols = file_content.shape[ 1 ]</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">if</span> ( ( nrows &gt; 1 ) <span class="keywordflow">and</span> ( ncols &gt; 1 ) ):</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;The gene list has to be provided either as a column&#39;</span> +</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                       <span class="stringliteral">&#39; or as a comma-separated values list.&#39;</span> )</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">elif</span> ( nrows &gt; 1 ):</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment"># Convert the column as a list    </span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            gene_list = file_content.iloc[:,0].tolist()</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">elif</span> ( ncols &gt; 1 ):</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment"># Convert the column as a list    </span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            gene_list = file_content.iloc[0,:].tolist()</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment"># Get the list of queries to use to insert data</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        queries_list = self.get_gene_list_queries( gene_list )</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment"># Proceed to the insertion</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        self.process_queries( queries_list )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    </div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a3eafb556691f2c60729015992fd5506a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eafb556691f2c60729015992fd5506a">&#9670;&nbsp;</a></span>get_cell_ctxt_queries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.get_cell_ctxt_queries </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>get_cell_ctxt_queries </h2>
<p>This methods allows to generate the list of appropriate queries to be used to get the content of the PRO database information using the selected cell contexts and necessary to perform the insertion in the FILT database.</p>
<dl class="section return"><dt>Returns</dt><dd>lists_to_insert: List - The list of queries to be used in order to filter the content of the PRO database to insert in the FILT database. </dd></dl>
<div class="fragment"><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">def </span>get_cell_ctxt_queries( self ):</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment"># NB: In order to facilitate the query on the PRO database, </span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment"># the filters are created by concatenation</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        filter_common = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        </div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">if</span> ( self.filt_type == Constants.FILTER_UNION ):</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                                                                CellContext.orftranscriptasso_id </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                                                                            ).filter( </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                                                        CellContext.cell_context.in_( self.cell_context )</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                                                                    ).distinct().all()</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment"># Otherwise, get the IDs of the ORFTranscriptAsso entries that have been </span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment"># associated with ALL the cell contexts of the list.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="comment"># For each of the context selected, get the list of OTA IDs </span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="comment"># related to it, and compute the intersection with the lists</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="comment"># get using the contexts already processed.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            all_ota_ids_intersect = set()</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">for</span> ctxt <span class="keywordflow">in</span> self.cell_context:</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                                                                    CellContext.orftranscriptasso_id </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                                                ).filter( </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                                                                            CellContext.cell_context == ctxt </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                                                                        ).distinct().all()</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                all_ota_ids = set( GeneralUtil.query_result_to_list( all_ota_ids ) )</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <span class="comment"># Get the intersection</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <span class="keywordflow">if</span> ( all_ota_ids_intersect ):</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    all_ota_ids_intersect = all_ota_ids.intersection( all_ota_ids_intersect )</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    all_ota_ids_intersect = all_ota_ids</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="comment"># Convert the set of OTA IDs associated with all of the categories</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="comment"># into a list</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            all_ota_ids = list( all_ota_ids_intersect )</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment"># Get all the CellContext entries related to these ORFTranscriptAsso IDs</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( CellContext.orftranscriptasso_id.in_(&#39;</span> + str( all_ota_ids ) + <span class="stringliteral">&#39;) )&#39;</span> + filter_common</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        all_cellcontext = self.query_PRO( <span class="stringliteral">&#39;CellContext&#39;</span>, filter_common )</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment"># Get all the CellContextCatalog entries that have at least one ORF</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="comment"># registered in the selected cell contexts</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        filter_cellcontextcatalog = <span class="stringliteral">&#39;.filter( CellContextCatalog.context == CellContext.cell_context )&#39;</span> + filter_common</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        all_cellcontextcatalog = self.query_PRO( <span class="stringliteral">&#39;CellContextCatalog&#39;</span>, filter_cellcontextcatalog )</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment"># Get the ORFTranscriptAsso entries</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( ORFTranscriptAsso.id == CellContext.orftranscriptasso_id )&#39;</span> + filter_common</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        all_orftranscriptasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAsso&#39;</span>, filter_common )</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment"># Get the ORFTranscriptAssoDSAsso entries</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        filter_otadsasso = <span class="stringliteral">&#39;.filter( ORFTranscriptAssoDSAsso.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        all_otadsasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAssoDSAsso&#39;</span>, filter_otadsasso )</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment"># Get the ORF entries</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        filter_orf = <span class="stringliteral">&#39;.filter( ORF.id == ORFTranscriptAsso.orf_id )&#39;</span> + filter_common</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        all_orf = self.query_PRO( <span class="stringliteral">&#39;ORF&#39;</span>, filter_orf )</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment"># Get the ORFDSAsso entries</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        filter_orfdsasso = <span class="stringliteral">&#39;.filter( ORFDSAsso.orf_id == ORF.id )&#39;</span> + filter_orf</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        all_orfdsasso = self.query_PRO( <span class="stringliteral">&#39;ORFDSAsso&#39;</span>, filter_orfdsasso )</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="comment"># Get the Transcript entries</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        filter_transcript = <span class="stringliteral">&#39;.filter( Transcript.id == ORFTranscriptAsso.transcript_id )&#39;</span> + filter_common</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        all_transcript = self.query_PRO( <span class="stringliteral">&#39;Transcript&#39;</span>, filter_transcript )</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment"># Get the TranscriptDSAsso entries</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        filter_transcriptdsasso = <span class="stringliteral">&#39;.filter( TranscriptDSAsso.transcript_id == Transcript.id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        all_transcriptds_asso = self.query_PRO( <span class="stringliteral">&#39;TranscriptDSAsso&#39;</span>, filter_transcriptdsasso )</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="comment"># Get the PROGene entries</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        filter_gene = <span class="stringliteral">&#39;.filter( PROGene.gene_id == Transcript.gene_id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        all_gene = self.query_PRO( <span class="stringliteral">&#39;PROGene&#39;</span>, filter_gene )</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="comment"># Get the PROGeneAlias entries</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        filter_genealias = <span class="stringliteral">&#39;.filter( PROGeneAlias.gene_id == PROGene.gene_id )&#39;</span> + filter_gene</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        all_genealias = self.query_PRO( <span class="stringliteral">&#39;PROGeneAlias&#39;</span>, filter_genealias )</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                </div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment"># Get the ProvidedCategory entries</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        filter_providedcat = <span class="stringliteral">&#39;.filter( ProvidedCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        all_providedcat = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategory&#39;</span>, filter_providedcat )</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment"># Get the ProvidedCategoryCatalog entries</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        filter_providedcatcatalog = <span class="stringliteral">&#39;.filter( ProvidedCategoryCatalog.category == ProvidedCategory.provided_category )&#39;</span> + filter_providedcat</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        all_providedcatcatalog = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategoryCatalog&#39;</span>, filter_providedcatcatalog )</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment"># Get the ORFCategory entries</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        filter_orfcat = <span class="stringliteral">&#39;.filter( ORFCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        all_orfcategory = self.query_PRO( <span class="stringliteral">&#39;ORFCategory&#39;</span>, filter_orfcat )</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="comment"># Get the ORFCategoryCatalog entries</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        filter_orfcategorycatalog = <span class="stringliteral">&#39;.filter( ORFCategoryCatalog.category == ORFCategory.orf_category )&#39;</span> + filter_orfcat</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        all_orfcategorycatalog = self.query_PRO( <span class="stringliteral">&#39;ORFCategoryCatalog&#39;</span>, filter_orfcategorycatalog )</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment"># Get the ORFAnnotation entries</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        filter_orfannotation = <span class="stringliteral">&#39;.filter( ORFAnnotation.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        all_orfannotation = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotation&#39;</span>, filter_orfannotation )</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment"># Get the ORFAnnotationCatalog entries</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        filter_orfannotationcatalog = <span class="stringliteral">&#39;.filter( ORFAnnotationCatalog.annotation == ORFAnnotation.orf_annotation )&#39;</span> + filter_orfannotation</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        all_orfannotationcatalog = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotationCatalog&#39;</span>, filter_orfannotationcatalog )</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="comment"># Get the FLOSSClass entries</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        filter_floss = <span class="stringliteral">&#39;.filter( FLOSSClass.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        all_floss = self.query_PRO( <span class="stringliteral">&#39;FLOSSClass&#39;</span>, filter_floss )</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment"># Get the FLOSSClassCatalog entries</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        filter_flosscatalog = <span class="stringliteral">&#39;.filter( FLOSSClassCatalog.floss_class == FLOSSClass.floss_class )&#39;</span> + filter_floss</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        all_flosscatalog = self.query_PRO( <span class="stringliteral">&#39;FLOSSClassCatalog&#39;</span>, filter_flosscatalog )</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment"># Return the list of queries containing all the data related to the cell context </span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment"># previously collected from the PRO database </span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        lists_to_insert = [ all_gene, all_genealias,</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                            all_orf, all_orfdsasso, </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            all_transcript, all_transcriptds_asso,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            all_orftranscriptasso, all_otadsasso,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                            all_cellcontextcatalog, all_cellcontext,</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            all_providedcatcatalog, all_providedcat,</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                            all_orfcategorycatalog, all_orfcategory,</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                            all_orfannotationcatalog, all_orfannotation,</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                            all_flosscatalog, all_floss ]</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">return</span> lists_to_insert</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         </div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a5943e5b4ac8c24e6378a66edc34bdb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5943e5b4ac8c24e6378a66edc34bdb47">&#9670;&nbsp;</a></span>get_gene_list_queries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.get_gene_list_queries </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>gene_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>get_gene_list_queries </h2>
<p>This methods allows to generate the list of appropriate queries to be used to get the content of the PRO database information using the selected ORF annotations and necessary to perform the insertion in the FILT database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gene_list</td><td>List - The list of gene symbols, aliases or IDs to use to filter the database.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>lists_to_insert: List - The list of queries to be used in order to filter the content of the PRO database to insert in the FILT database. </dd></dl>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">def </span>get_gene_list_queries( self, gene_list ):</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment"># NB: In order to facilitate the query on the PRO database, </span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="comment">#     the filters are created by concatenation</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        filter_common = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        all_gene_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                                            PROGeneAlias.gene_id  </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                                                                        ).filter( </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                                                    PROGeneAlias.alias.in_( gene_list )</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                                                ).distinct().all()</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment"># Get all the PROGene entries related to these ORFTranscriptAsso IDs</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( PROGene.gene_id.in_(&#39;</span> + str( all_gene_ids ) + <span class="stringliteral">&#39;) )&#39;</span> + filter_common</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        all_gene = self.query_PRO( <span class="stringliteral">&#39;PROGene&#39;</span>, filter_common )</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment"># Get all the PROGeneAlias entries related to the PROGene entries selected</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        filter_genealias = <span class="stringliteral">&#39;.filter( PROGeneAlias.gene_id == PROGene.gene_id )&#39;</span> + filter_common</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        all_genealias = self.query_PRO( <span class="stringliteral">&#39;PROGeneAlias&#39;</span>, filter_genealias )</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment"># Get the Transcript entries</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( Transcript.gene_id == PROGene.gene_id )&#39;</span> + filter_common</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        all_transcript = self.query_PRO( <span class="stringliteral">&#39;Transcript&#39;</span>, filter_common )</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        </div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment"># Get the TranscriptDSAsso entries</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        filter_transcriptdsasso = <span class="stringliteral">&#39;.filter( TranscriptDSAsso.transcript_id == Transcript.id )&#39;</span> + filter_common</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        all_transcriptds_asso = self.query_PRO( <span class="stringliteral">&#39;TranscriptDSAsso&#39;</span>, filter_transcriptdsasso )</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        </div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment"># Get the ORFTranscriptAsso entries</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        filter_ota = <span class="stringliteral">&#39;.filter( ORFTranscriptAsso.transcript_id == Transcript.id )&#39;</span> + filter_common</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        all_orftranscriptasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAsso&#39;</span>, filter_ota )</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment"># Get the ORFTranscriptAssoDSAsso entries</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        filter_otadsasso = <span class="stringliteral">&#39;.filter( ORFTranscriptAssoDSAsso.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        all_otadsasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAssoDSAsso&#39;</span>, filter_otadsasso )</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment"># Get the ORF entries</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        filter_orf = <span class="stringliteral">&#39;.filter( ORF.id == ORFTranscriptAsso.orf_id )&#39;</span> + filter_ota</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        all_orf = self.query_PRO( <span class="stringliteral">&#39;ORF&#39;</span>, filter_orf )</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment"># Get the ORFDSAsso entries</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        filter_orfdsasso = <span class="stringliteral">&#39;.filter( ORFDSAsso.orf_id == ORF.id )&#39;</span> + filter_orf</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        all_orfdsasso = self.query_PRO( <span class="stringliteral">&#39;ORFDSAsso&#39;</span>, filter_orfdsasso )</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            </div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment"># Get the ORFCategory entries</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        filter_orfcat = <span class="stringliteral">&#39;.filter( ORFCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        all_orfcategory = self.query_PRO( <span class="stringliteral">&#39;ORFCategory&#39;</span>, filter_orfcat )</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment"># Get the ORFCategoryCatalog entries</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        filter_orfcatcatalog = <span class="stringliteral">&#39;.filter( ORFCategoryCatalog.category == ORFCategory.orf_category )&#39;</span> + filter_orfcat</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        all_orfcatcatalog = self.query_PRO( <span class="stringliteral">&#39;ORFCategoryCatalog&#39;</span>, filter_orfcatcatalog )</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment"># Get the CellContext entries</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        filter_cellcontext = <span class="stringliteral">&#39;.filter( CellContext.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        all_cellcontext = self.query_PRO( <span class="stringliteral">&#39;CellContext&#39;</span>, filter_cellcontext )</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment"># Get the CellContextCatalog entries</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        filter_cellcontextcatalog = <span class="stringliteral">&#39;.filter( CellContextCatalog.context == CellContext.cell_context )&#39;</span> + filter_cellcontext</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        all_cellcontextcatalog = self.query_PRO( <span class="stringliteral">&#39;CellContextCatalog&#39;</span>, filter_cellcontextcatalog )</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment"># Get the ProvidedCategory entries</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        filter_providedcat = <span class="stringliteral">&#39;.filter( ProvidedCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        all_providedcat = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategory&#39;</span>, filter_providedcat )</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="comment"># Get the ProvidedCategoryCatalog entries</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        filter_providedcatcatalog = <span class="stringliteral">&#39;.filter( ProvidedCategoryCatalog.category == ProvidedCategory.provided_category )&#39;</span> + filter_providedcat</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        all_providedcatcatalog = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategoryCatalog&#39;</span>, filter_providedcatcatalog )</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment"># Get the FLOSSClass entries</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        filter_floss = <span class="stringliteral">&#39;.filter( FLOSSClass.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        all_floss = self.query_PRO( <span class="stringliteral">&#39;FLOSSClass&#39;</span>, filter_floss )</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment"># Get the FLOSSClassCatalog entries</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        filter_flosscatalog = <span class="stringliteral">&#39;.filter( FLOSSClassCatalog.floss_class == FLOSSClass.floss_class )&#39;</span> + filter_floss</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        all_flosscatalog = self.query_PRO( <span class="stringliteral">&#39;FLOSSClassCatalog&#39;</span>, filter_flosscatalog )</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        </div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment"># Get the ORFAnnotation entries</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        filter_orfannotation = <span class="stringliteral">&#39;.filter( ORFAnnotation.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_ota</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        all_orfannotation = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotation&#39;</span>, filter_orfannotation )</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment"># Get the ORFAnnotationCatalog entries</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        filter_orfannotationcatalog = <span class="stringliteral">&#39;.filter( ORFAnnotationCatalog.annotation == ORFAnnotation.orf_annotation )&#39;</span> + filter_orfannotation</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        all_orfannotationcatalog = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotationCatalog&#39;</span>, filter_orfannotationcatalog )</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        </div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="comment"># Return the list of queries containing all the data related to the gene symbol / ID / name</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="comment"># previously collected from the PRO database </span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        lists_to_insert = [ all_gene, all_genealias,</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                            all_orf, all_orfdsasso, </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                            all_transcript, all_transcriptds_asso,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                            all_orftranscriptasso, all_otadsasso,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            all_cellcontextcatalog, all_cellcontext, </div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                            all_providedcatcatalog, all_providedcat,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                            all_flosscatalog, all_floss,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                            all_orfcatcatalog, all_orfcategory,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                            all_orfannotationcatalog, all_orfannotation ]</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">return</span> lists_to_insert</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a20e22e8f32269847ec545e6d361db019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20e22e8f32269847ec545e6d361db019">&#9670;&nbsp;</a></span>get_orf_annot_queries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.get_orf_annot_queries </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>get_orf_annot_queries </h2>
<p>This methods allows to generate the list of appropriate queries to be used to get the content of the PRO database information using the selected ORF annotations and necessary to perform the insertion in the FILT database.</p>
<dl class="section return"><dt>Returns</dt><dd>lists_to_insert: List - The list of queries to be used in order to filter the content of the PRO database to insert in the FILT database. </dd></dl>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keyword">def </span>get_orf_annot_queries( self ):</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="comment"># NB: In order to facilitate the query on the PRO database, </span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <span class="comment"># the filters are created by concatenation</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        filter_common = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> ( self.filt_type == Constants.FILTER_UNION ):</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                                                                ORFAnnotation.orftranscriptasso_id </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                                                            ).filter( </div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                                                                        ORFAnnotation.orf_annotation.in_( self.orf_annotations )</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                                                                    ).distinct().all()</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        </div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment"># Otherwise, get the IDs of the ORFTranscriptAsso entries that have been </span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment"># associated with ALL the annotations of the list.</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="comment"># For each of the annotation selected, get the list of OTA IDs </span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="comment"># related to it, and compute the intersection with the lists</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            <span class="comment"># get using the annotations already processed.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            all_ota_ids_intersect = set()</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordflow">for</span> orf_annot <span class="keywordflow">in</span> self.orf_annotations:</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                                                                    ORFAnnotation.orftranscriptasso_id </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                                                                ).filter( </div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                                                                            ORFAnnotation.orf_annotation == orf_annot </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                                                                        ).distinct().all()</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                all_ota_ids = set( GeneralUtil.query_result_to_list( all_ota_ids ) )</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <span class="comment"># Get the intersection</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                <span class="keywordflow">if</span> ( all_ota_ids_intersect ):</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                    all_ota_ids_intersect = all_ota_ids.intersection( all_ota_ids_intersect )</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    all_ota_ids_intersect = all_ota_ids</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            </div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="comment"># Convert the set of OTA IDs associated with all </span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="comment"># of the annotations into a list</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            all_ota_ids = list( all_ota_ids_intersect )</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="comment"># Get all the ORFAnnotation entries related to these ORFTranscriptAsso IDs</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( ORFAnnotation.orftranscriptasso_id.in_(&#39;</span> + str( all_ota_ids ) + <span class="stringliteral">&#39;) )&#39;</span> + filter_common</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        all_orfannotation = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotation&#39;</span>, filter_common )</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        </div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="comment"># Get all the ORFAnnotationCatalog entries that have at least one ORF</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="comment"># registered in the selected annotation</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        filter_orfannotationcatalog = <span class="stringliteral">&#39;.filter( ORFAnnotationCatalog.annotation == ORFAnnotation.orf_annotation )&#39;</span> + filter_common</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        all_orfannotationcatalog = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotationCatalog&#39;</span>, filter_orfannotationcatalog )</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="comment"># Get the ORFTranscriptAsso entries</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( ORFTranscriptAsso.id == ORFAnnotation.orftranscriptasso_id )&#39;</span> + filter_common</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        all_orftranscriptasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAsso&#39;</span>, filter_common )</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="comment"># Get the ORFTranscriptAssoDSAsso entries</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        filter_otadsasso = <span class="stringliteral">&#39;.filter( ORFTranscriptAssoDSAsso.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        all_otadsasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAssoDSAsso&#39;</span>, filter_otadsasso )</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="comment"># Get the ORF entries</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        filter_orf = <span class="stringliteral">&#39;.filter( ORF.id == ORFTranscriptAsso.orf_id )&#39;</span> + filter_common</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        all_orf = self.query_PRO( <span class="stringliteral">&#39;ORF&#39;</span>, filter_orf )</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        </div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="comment"># Get the ORFDSAsso entries</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        filter_orfdsasso = <span class="stringliteral">&#39;.filter( ORFDSAsso.orf_id == ORF.id )&#39;</span> + filter_orf</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        all_orfdsasso = self.query_PRO( <span class="stringliteral">&#39;ORFDSAsso&#39;</span>, filter_orfdsasso )</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="comment"># Get the Transcript entries</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        filter_transcript = <span class="stringliteral">&#39;.filter( Transcript.id == ORFTranscriptAsso.transcript_id )&#39;</span> + filter_common</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        all_transcript = self.query_PRO( <span class="stringliteral">&#39;Transcript&#39;</span>, filter_transcript )</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        </div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment"># Get the TranscriptDSAsso entries</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        filter_transcriptdsasso = <span class="stringliteral">&#39;.filter( TranscriptDSAsso.transcript_id == Transcript.id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        all_transcriptds_asso = self.query_PRO( <span class="stringliteral">&#39;TranscriptDSAsso&#39;</span>, filter_transcriptdsasso )</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        </div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="comment"># Get the PROGene entries</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        filter_gene = <span class="stringliteral">&#39;.filter( PROGene.gene_id == Transcript.gene_id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        all_gene = self.query_PRO( <span class="stringliteral">&#39;PROGene&#39;</span>, filter_gene )</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        </div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment"># Get the PROGeneAlias entries</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        filter_genealias = <span class="stringliteral">&#39;.filter( PROGeneAlias.gene_id == PROGene.gene_id )&#39;</span> + filter_gene</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        all_genealias = self.query_PRO( <span class="stringliteral">&#39;PROGeneAlias&#39;</span>, filter_genealias )</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        </div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment"># Get the CellContext entries</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        filter_cellcontext = <span class="stringliteral">&#39;.filter( CellContext.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        all_cellcontext = self.query_PRO( <span class="stringliteral">&#39;CellContext&#39;</span>, filter_cellcontext )</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        </div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment"># Get the CellContextCatalog entries</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        filter_cellcontextcatalog = <span class="stringliteral">&#39;.filter( CellContextCatalog.context == CellContext.cell_context )&#39;</span> + filter_cellcontext</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        all_cellcontextcatalog = self.query_PRO( <span class="stringliteral">&#39;CellContextCatalog&#39;</span>, filter_cellcontextcatalog )</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        </div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment"># Get the ProvidedCategory entries</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        filter_providedcat = <span class="stringliteral">&#39;.filter( ProvidedCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        all_providedcat = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategory&#39;</span>, filter_providedcat )</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        </div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="comment"># Get the ProvidedCategoryCatalog entries</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        filter_providedcatcatalog = <span class="stringliteral">&#39;.filter( ProvidedCategoryCatalog.category == ProvidedCategory.provided_category )&#39;</span> + filter_providedcat</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        all_providedcatcatalog = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategoryCatalog&#39;</span>, filter_providedcatcatalog )</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        </div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="comment"># Get the ORFCategory entries</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        filter_orfcategory = <span class="stringliteral">&#39;.filter( ORFCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        all_orfcategory = self.query_PRO( <span class="stringliteral">&#39;ORFCategory&#39;</span>, filter_orfcategory )</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="comment"># Get the ORFCategoryCatalog entries</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        filter_orfcategorycatalog = <span class="stringliteral">&#39;.filter( ORFCategoryCatalog.category == ORFCategory.orf_category )&#39;</span> + filter_orfcategory</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        all_orfcategorycatalog = self.query_PRO( <span class="stringliteral">&#39;ORFCategoryCatalog&#39;</span>, filter_orfcategorycatalog )</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        </div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="comment"># Get the FLOSSClass entries</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        filter_floss = <span class="stringliteral">&#39;.filter( FLOSSClass.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        all_floss = self.query_PRO( <span class="stringliteral">&#39;FLOSSClass&#39;</span>, filter_floss )</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="comment"># Get the FLOSSClassCatalog entries</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        filter_flosscatalog = <span class="stringliteral">&#39;.filter( FLOSSClassCatalog.floss_class == FLOSSClass.floss_class )&#39;</span> + filter_floss</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        all_flosscatalog = self.query_PRO( <span class="stringliteral">&#39;FLOSSClassCatalog&#39;</span>, filter_flosscatalog )</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="comment"># Return the list of queries containing all the data related to the ORF annotation</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="comment"># previously collected from the PRO database </span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        lists_to_insert = [ all_gene, all_genealias,</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                            all_orf, all_orfdsasso, </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                            all_transcript, all_transcriptds_asso,</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                            all_orftranscriptasso, all_otadsasso,</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                            all_orfannotationcatalog, all_orfannotation,</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                            all_cellcontextcatalog, all_cellcontext,</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                            all_providedcatcatalog, all_providedcat, </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                            all_orfcategorycatalog, all_orfcategory,</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                            all_flosscatalog, all_floss ]</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="keywordflow">return</span> lists_to_insert</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    </div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<a id="a63f2370e4312a7cce004958cc7a9a9d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63f2370e4312a7cce004958cc7a9a9d7">&#9670;&nbsp;</a></span>get_orf_cat_queries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.get_orf_cat_queries </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>get_orf_cat_queries </h2>
<p>This methods allows to generate the list of appropriate queries to be used to get the content of the PRO database information using the selected ORF categories and necessary to perform the insertion in the FILT database.</p>
<dl class="section return"><dt>Returns</dt><dd>lists_to_insert: List - The list of queries to be used in order to filter the content of the PRO database to insert in the FILT database. </dd></dl>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keyword">def </span>get_orf_cat_queries( self ):</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment"># NB: In order to facilitate the query on the PRO database, </span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment"># the filters are created by concatenation</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        filter_common = <span class="stringliteral">&#39;&#39;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        </div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">if</span> ( self.filt_type == Constants.FILTER_UNION ):</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                                                                ORFCategory.orftranscriptasso_id </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                                                            ).filter( </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                                                                        ORFCategory.orf_category.in_( self.orf_categories )</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                                                                    ).distinct().all()</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="comment"># Otherwise, get the IDs of the ORFTranscriptAsso entries that have been </span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="comment"># associated with ALL the categories of the list.</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="comment"># For each of the category selected, get the list of OTA IDs </span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="comment"># related to it, and compute the intersection with the lists</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="comment"># get using the categories already processed.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            all_ota_ids_intersect = set()</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">for</span> orf_cat <span class="keywordflow">in</span> self.orf_categories:</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                all_ota_ids = SQLManagerPRO.get_instance().get_session().query( </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                                                    ORFCategory.orftranscriptasso_id </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                                                                ).filter( </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                                                            ORFCategory.orf_category == orf_cat </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                                                                        ).distinct().all()</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                all_ota_ids = set( GeneralUtil.query_result_to_list( all_ota_ids ) )</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="comment"># Get the intersection</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                <span class="keywordflow">if</span> ( all_ota_ids_intersect ):</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    all_ota_ids_intersect = all_ota_ids.intersection( all_ota_ids_intersect )</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    all_ota_ids_intersect = all_ota_ids</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="comment"># Convert the set of OTA IDs associated with all of the categories</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment"># into a list</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            all_ota_ids = list( all_ota_ids_intersect )</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment"># Get all the ORFCategory entries related to these ORFTranscriptAsso IDs</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( ORFCategory.orftranscriptasso_id.in_(&#39;</span> + str( all_ota_ids ) + <span class="stringliteral">&#39;) )&#39;</span> + filter_common</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        all_orfcategory = self.query_PRO( <span class="stringliteral">&#39;ORFCategory&#39;</span>, filter_common )</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="comment"># Get all the ORFCategoryCatalog entries that have at least one ORF</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment"># registered in the selected category</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        filter_orfcategorycatalog = <span class="stringliteral">&#39;.filter( ORFCategoryCatalog.category == ORFCategory.orf_category )&#39;</span> + filter_common</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        all_orfcategorycatalog = self.query_PRO( <span class="stringliteral">&#39;ORFCategoryCatalog&#39;</span>, filter_orfcategorycatalog )</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                      </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="comment"># Get the ORFTranscriptAsso entries</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        filter_common = <span class="stringliteral">&#39;.filter( ORFTranscriptAsso.id == ORFCategory.orftranscriptasso_id )&#39;</span> + filter_common</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        all_orftranscriptasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAsso&#39;</span>, filter_common )</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="comment"># Get the ORFTranscriptAssoDSAsso entries</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        filter_otadsasso = <span class="stringliteral">&#39;.filter( ORFTranscriptAssoDSAsso.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        all_otadsasso = self.query_PRO( <span class="stringliteral">&#39;ORFTranscriptAssoDSAsso&#39;</span>, filter_otadsasso )</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment"># Get the ORF entries</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        filter_orf = <span class="stringliteral">&#39;.filter( ORF.id == ORFTranscriptAsso.orf_id )&#39;</span> + filter_common</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        all_orf = self.query_PRO( <span class="stringliteral">&#39;ORF&#39;</span>, filter_orf )</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        </div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="comment"># Get the ORFDSAsso entries</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        filter_orfdsasso = <span class="stringliteral">&#39;.filter( ORFDSAsso.orf_id == ORF.id )&#39;</span> + filter_orf</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        all_orfdsasso = self.query_PRO( <span class="stringliteral">&#39;ORFDSAsso&#39;</span>, filter_orfdsasso )</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment"># Get the Transcript entries</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        filter_transcript = <span class="stringliteral">&#39;.filter( Transcript.id == ORFTranscriptAsso.transcript_id )&#39;</span> + filter_common</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        all_transcript = self.query_PRO( <span class="stringliteral">&#39;Transcript&#39;</span>, filter_transcript )</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        </div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment"># Get the TranscriptDSAsso entries</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        filter_transcriptdsasso = <span class="stringliteral">&#39;.filter( TranscriptDSAsso.transcript_id == Transcript.id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        all_transcriptds_asso = self.query_PRO( <span class="stringliteral">&#39;TranscriptDSAsso&#39;</span>, filter_transcriptdsasso )</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment"># Get the PROGene entries</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        filter_gene = <span class="stringliteral">&#39;.filter( PROGene.gene_id == Transcript.gene_id )&#39;</span> + filter_transcript</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        all_gene = self.query_PRO( <span class="stringliteral">&#39;PROGene&#39;</span>, filter_gene )</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment"># Get the PROGeneAlias entries</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        filter_genealias = <span class="stringliteral">&#39;.filter( PROGeneAlias.gene_id == PROGene.gene_id )&#39;</span> + filter_gene</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        all_genealias = self.query_PRO( <span class="stringliteral">&#39;PROGeneAlias&#39;</span>, filter_genealias )</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment"># Get the CellContext entries</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        filter_cellcontext = <span class="stringliteral">&#39;.filter( CellContext.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        all_cellcontext = self.query_PRO( <span class="stringliteral">&#39;CellContext&#39;</span>, filter_cellcontext )</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment"># Get the CellContextCatalog entries</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        filter_cellcontextcatalog = <span class="stringliteral">&#39;.filter( CellContextCatalog.context == CellContext.cell_context )&#39;</span> + filter_cellcontext</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        all_cellcontextcatalog = self.query_PRO( <span class="stringliteral">&#39;CellContextCatalog&#39;</span>, filter_cellcontextcatalog )</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="comment"># Get the ProvidedCategory entries</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        filter_providedcat = <span class="stringliteral">&#39;.filter( ProvidedCategory.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        all_providedcat = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategory&#39;</span>, filter_providedcat )</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment"># Get the ProvidedCategoryCatalog entries</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        filter_providedcatcatalog = <span class="stringliteral">&#39;.filter( ProvidedCategoryCatalog.category == ProvidedCategory.provided_category )&#39;</span> + filter_providedcat</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        all_providedcatcatalog = self.query_PRO( <span class="stringliteral">&#39;ProvidedCategoryCatalog&#39;</span>, filter_providedcatcatalog )</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment"># Get the ORFAnnotation entries</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        filter_orfannotation = <span class="stringliteral">&#39;.filter( ORFAnnotation.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        all_orfannotation = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotation&#39;</span>, filter_orfannotation )</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="comment"># Get the ORFAnnotationCatalog entries</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        filter_orfannotationcatalog = <span class="stringliteral">&#39;.filter( ORFAnnotationCatalog.annotation == ORFAnnotation.orf_annotation )&#39;</span> + filter_orfannotation</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        all_orfannotationcatalog = self.query_PRO( <span class="stringliteral">&#39;ORFAnnotationCatalog&#39;</span>, filter_orfannotationcatalog )</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="comment"># Get the FLOSSClass entries</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        filter_floss = <span class="stringliteral">&#39;.filter( FLOSSClass.orftranscriptasso_id == ORFTranscriptAsso.id )&#39;</span> + filter_common</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        all_floss = self.query_PRO( <span class="stringliteral">&#39;FLOSSClass&#39;</span>, filter_floss )</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="comment"># Get the FLOSSClassCatalog entries</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        filter_flosscatalog = <span class="stringliteral">&#39;.filter( FLOSSClassCatalog.floss_class == FLOSSClass.floss_class )&#39;</span> + filter_floss</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        all_flosscatalog = self.query_PRO( <span class="stringliteral">&#39;FLOSSClassCatalog&#39;</span>, filter_flosscatalog )</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        </div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="comment"># Return the list of queries containing all the data related to the ORF category</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="comment"># previously collected from the PRO database </span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        lists_to_insert = [ all_gene, all_genealias,</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                            all_orf, all_orfdsasso,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                            all_transcript, all_transcriptds_asso, </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                            all_orftranscriptasso, all_otadsasso,</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                            all_orfcategorycatalog, all_orfcategory,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                            all_cellcontextcatalog, all_cellcontext,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                            all_providedcatcatalog, all_providedcat, </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                            all_orfannotationcatalog, all_orfannotation,</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                            all_flosscatalog, all_floss ]</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">return</span> lists_to_insert</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="ac2c1f7d5c24efe05da45c51214972b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2c1f7d5c24efe05da45c51214972b2c">&#9670;&nbsp;</a></span>orf_annotations_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.orf_annotations_filter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>orf_annotations_filter </h2>
<p>This methods allows to filter the PRO database information using the provided list of ORF annotations and to insert it into the FILT database. </p>
<div class="fragment"><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keyword">def </span>orf_annotations_filter( self ):</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment"># Get the list of queries to use to insert data</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        queries_list = self.get_orf_annot_queries()</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="comment"># Proceed to the insertion</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        self.process_queries( queries_list )</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a9f29b7cfdea7b2fdc0c22385c600027b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f29b7cfdea7b2fdc0c22385c600027b">&#9670;&nbsp;</a></span>orf_categories_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.orf_categories_filter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>orf_categories_filter </h2>
<p>This methods allows to filter the PRO database information using the provided list of ORF category and to insert it into the FILT database. </p>
<div class="fragment"><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keyword">def </span>orf_categories_filter( self ):</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="comment"># Get the list of queries to use to insert data</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        queries_list = self.get_orf_cat_queries()</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="comment"># Proceed to the insertion</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        self.process_queries( queries_list )</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a87171f9fabc296e443a46bc108790e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87171f9fabc296e443a46bc108790e2c">&#9670;&nbsp;</a></span>parse_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.parse_config </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>parse_config </h2>
<p>Parse the config file to retrieve required information.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When expected filter section may not be found in the config file. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>When there is no strategy of filtering provided. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>When there are several strategies of filtering provided. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>When the type of filtering provided is not allowed (i.e. neither 'intersection' nor 'union'). </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>When a list of genes has been provided to perform the filtering and the type has been set to 'intersection'.. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">def </span>parse_config( self ):</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment"># Read the configfile</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        config = ConfigParser.ConfigParser()</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        config.optionxform = <span class="keyword">lambda</span> option: option</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        config.read( self.configfile )</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        </div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment"># Check the filter section is well provided in the config file</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> config.has_section( Constants.CONFIG_SECTION_FILTER ):</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            </div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            self.selected_strat_count = 0</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment"># Get the type of filtering to use (either union or intersection)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="comment"># By default, the type union is selected, as the queries writen for this </span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="comment"># type could be performed is there is one single element in the list.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keywordflow">if</span> config.has_option( Constants.CONFIG_SECTION_FILTER, Constants.CONFIG_SECTION_FILTER_ITEM_TYPE ):</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                self.filt_type = config.get( Constants.CONFIG_SECTION_FILTER, </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                             Constants.CONFIG_SECTION_FILTER_ITEM_TYPE )</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                if( self.filt_type <span class="keywordflow">not</span> <span class="keywordflow">in</span> [ Constants.FILTER_INTERSECTION, Constants.FILTER_UNION ] ):</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;The filtering type provided (&#39;</span> + str( self.filt_type ) +</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                               <span class="stringliteral">&#39;) is not allowed. You need to select either &#39;</span> + </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                               Constants.FILTER_INTERSECTION + <span class="stringliteral">&#39; or &#39;</span> + Constants.FILTER_UNION + </div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                               <span class="stringliteral">&#39;. Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                self.filt_type = Constants.FILTER_UNION</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                Logger.get_instance().debug( <span class="stringliteral">&#39;As there was no filtering type provided in the config file,&#39;</span> +</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                             <span class="stringliteral">&#39; the filtering strategy will be run using the &#39;</span> + </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                             Constants.FILTER_UNION + <span class="stringliteral">&#39; parameter.&#39;</span> )</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            </div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="comment"># Get the path to the file containing the gene list</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> config.has_option( Constants.CONFIG_SECTION_FILTER, Constants.CONFIG_SECTION_FILTER_ITEM_GENE_LIST ):</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                self.selected_strat_count += 1</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                self.gene_list = config.get( Constants.CONFIG_SECTION_FILTER, </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                             Constants.CONFIG_SECTION_FILTER_ITEM_GENE_LIST )</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                self.gene_list = <span class="keywordtype">None</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                </div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="comment"># Get the list of cell contexts to use to filter the PRO database</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">if</span> config.has_option( Constants.CONFIG_SECTION_FILTER, Constants.CONFIG_SECTION_FILTER_ITEM_CELL_CONTEXT ):</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                self.selected_strat_count += 1</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                self.cell_context = config.get( Constants.CONFIG_SECTION_FILTER, </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                Constants.CONFIG_SECTION_FILTER_ITEM_CELL_CONTEXT )</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <span class="comment"># Replace the eventual spaces nears to the comma and convert the string as a list</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                self.cell_context = self.cell_context.replace( <span class="stringliteral">&#39;, &#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).replace( <span class="stringliteral">&#39; ,&#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).split( <span class="stringliteral">&#39;,&#39;</span> )</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                self.cell_context = <span class="keywordtype">None</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment"># Get the list of ORF categories to use to filter the PRO database</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> config.has_option( Constants.CONFIG_SECTION_FILTER, Constants.CONFIG_SECTION_FILTER_ITEM_ORF_CAT ):</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                self.selected_strat_count += 1</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                self.orf_categories = config.get( Constants.CONFIG_SECTION_FILTER, </div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                  Constants.CONFIG_SECTION_FILTER_ITEM_ORF_CAT )</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="comment"># Replace the eventual spaces nears to the comma and convert the string as a list</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                self.orf_categories = self.orf_categories.replace( <span class="stringliteral">&#39;, &#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).replace( <span class="stringliteral">&#39; ,&#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).split( <span class="stringliteral">&#39;,&#39;</span> )</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                self.orf_categories = <span class="keywordtype">None</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="comment"># Get the list of ORF annotations to use to filter the PRO database</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">if</span> config.has_option( Constants.CONFIG_SECTION_FILTER, Constants.CONFIG_SECTION_FILTER_ITEM_ORF_ANNOT ):</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                self.selected_strat_count += 1</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                self.orf_annotations = config.get( Constants.CONFIG_SECTION_FILTER, </div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                   Constants.CONFIG_SECTION_FILTER_ITEM_ORF_ANNOT )</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="comment"># Replace the eventual spaces nears to the comma and convert the string as a list</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                self.orf_annotations = self.orf_annotations.replace( <span class="stringliteral">&#39;, &#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).replace( <span class="stringliteral">&#39; ,&#39;</span>, <span class="stringliteral">&#39;,&#39;</span> ).split( <span class="stringliteral">&#39;,&#39;</span> )</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                self.orf_annotations = <span class="keywordtype">None</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment"># If there is no gene list and no cell context provided, raise an exception</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">if</span> ( self.selected_strat_count == 0 ):</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy: A strategy of filtering has to be provided,&#39;</span> +</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                           <span class="stringliteral">&#39; i.e. the path to a file containing a gene list (item &#39;</span> + </div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                           Constants.CONFIG_SECTION_FILTER_ITEM_GENE_LIST + <span class="stringliteral">&#39;),&#39;</span> +</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                           <span class="stringliteral">&#39; or a comma-separated list of cellular context (item &#39;</span> + </div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                           Constants.CONFIG_SECTION_FILTER_ITEM_CELL_CONTEXT + <span class="stringliteral">&#39;),&#39;</span> + </div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                           <span class="stringliteral">&#39; or a comma-separated list of ORF categories (item &#39;</span> +</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                           Constants.CONFIG_SECTION_FILTER_ITEM_ORF_CAT + </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                           <span class="stringliteral">&#39;) has to be provided.&#39;</span>  )</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment"># If several strategies of filtering have been selected, raise an exception</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> ( self.selected_strat_count &gt; 1 ):</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="comment"># NB: This strategy has been built with the idea that only one strategy of filtering will </span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="comment">#     be applied at a time. If necessary it may be easily updated to use both strategies </span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="comment">#     of filtering. To do so, the easiest way would be to use an intermediate database </span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="comment">#     containing the filtered data from the first list query, and to make the second list </span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="comment">#     of queries on this intermediate database to build the final one. This would probably</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="comment">#     improve the time of computation compared with making the two list of queries at the</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="comment">#     same time.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy: Several strategies of filtering cannot be&#39;</span> +</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                           <span class="stringliteral">&#39; provided at the same time. Please provide only one of the&#39;</span> +</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                           <span class="stringliteral">&#39; following items in the config file: &#39;</span> + </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                           Constants.CONFIG_SECTION_FILTER_ITEM_GENE_LIST + </div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                                           <span class="stringliteral">&#39;, &#39;</span> + Constants.CONFIG_SECTION_FILTER_ITEM_CELL_CONTEXT + </div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                           <span class="stringliteral">&#39;, &#39;</span> + Constants.CONFIG_SECTION_FILTER_ITEM_ORF_CAT +</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                           <span class="stringliteral">&#39;, &#39;</span> + Constants.CONFIG_SECTION_FILTER_ITEM_ORF_ANNOT +</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                           <span class="stringliteral">&#39;. Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment"># If a list of gene has been provided, the filtering type should </span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment"># necessarily be set to &#39;union&#39;. If this is not the case, then </span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment"># raise an exception.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> ( self.gene_list </div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                 <span class="keywordflow">and</span> ( self.filt_type == Constants.FILTER_INTERSECTION ) ):</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;A list of genes has been provided for the filtering whilst&#39;</span> +</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                           <span class="stringliteral">&#39; the type of filtering has been set to &#39;</span> +  </div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                           Constants.FILTER_INTERSECTION + </div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                           <span class="stringliteral">&#39;. This is not allowed as, according to the database&#39;</span> +</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                           <span class="stringliteral">&#39; relationships a transcript can only belong to one unique gene&#39;</span> +</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                           <span class="stringliteral">&#39; (even if it could obviously be related to several aliases&#39;</span> +</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                           <span class="stringliteral">&#39; which are themselves related to the same single gene).&#39;</span> +</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                           <span class="stringliteral">&#39; Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy: The &#39;</span> + Constants.CONFIG_SECTION_FILTER + </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                       <span class="stringliteral">&#39; section has to be provided in the config file.&#39;</span> )</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    </div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    </div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a037753ed8b0c301025d9c036fdd79062"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a037753ed8b0c301025d9c036fdd79062">&#9670;&nbsp;</a></span>PRO_to_FILT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.PRO_to_FILT </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>query</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>PRO_to_FILT </h2>
<p>This method allows to get all the object reported by a query on the PRO database, detach them from the session and insert them in the FILT database.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>SQLAlchemy Query - The SQLAlchemy query allowing to get the entries to insert in the FILT database.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When an exception as been raised trying to insert the data and commit the changes. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keyword">def </span>PRO_to_FILT( self, query ):</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        </div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span> ( query <span class="keywordflow">and</span> ( query.count() != 0 ) ):</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="comment"># Expunge the session to the PRO database to detach the objects in the list from the session</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            SQLManagerPRO.get_instance().get_session().expunge_all()</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            <span class="comment"># Insert the objects of the list in the FILT database</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <span class="keywordflow">for</span> entry <span class="keywordflow">in</span> query.all():</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                    SQLManagerFILT.get_instance().get_session().merge( entry )</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy().PRO_to_FILT(): An exception occurred&#39;</span> +</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                               <span class="stringliteral">&#39; trying to insert the data in the FILT database&#39;</span> +</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                               <span class="stringliteral">&#39; (using the session.merge() method).&#39;</span>, e )</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            <span class="keywordflow">try</span>: </div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                SQLManagerFILT.get_instance().commit()</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;FilterStrategy().PRO_to_FILT(): An exception occurred&#39;</span> +</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                           <span class="stringliteral">&#39; trying to commit changes after insertion of data in&#39;</span> +</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                           <span class="stringliteral">&#39; the FILT database.&#39;</span>, e )</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        SQLManagerFILT.get_instance().close_session()</div></div><!-- fragment -->
</div>
</div>
<a id="ad331f970e2a01e4a38efc917a50cf4f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad331f970e2a01e4a38efc917a50cf4f3">&#9670;&nbsp;</a></span>process_queries()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.process_queries </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>queries_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>process_queries </h2>
<p>This methods allows to process a list of queries previously generated and that allows to filter the content of the PRO database that needs to be used in the FILT database. </p>
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keyword">def </span>process_queries( self, queries_list ):</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="comment"># Get the total number of queries to process and reset </span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="comment"># the ProgressionBar instance to follow the progression</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        ProgressionBar.get_instance().reset_instance( total = len( queries_list ) )</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">for</span> query <span class="keywordflow">in</span> queries_list:</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="comment"># Update and display the progression bar on the console</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            ProgressionBar.get_instance().increase_and_display()</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            self.PRO_to_FILT( query )</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    </div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a1f0100c31b64f7ebf6509612c4a6f9d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f0100c31b64f7ebf6509612c4a6f9d3">&#9670;&nbsp;</a></span>query_PRO()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.query_PRO </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>classname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>query_PRO </h2>
<p>This method allows to build a particular query to the PRO database, using a filter built by concatenation and querying a particular table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">classname</td><td>String - The name of the DenCellORF class to query. e.g. PROGene. </td></tr>
    <tr><td class="paramname">filter</td><td>String - The filter to apply on the query. e.g. '.filter( PROGeneAlias.alias == "GADD34" )'</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SQLAlchemy Query - <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1util_1_1sql_1_1SQLManagerPRO_1_1SQLManagerPRO.html#a8a56d22bd94d8752682edb42aa7d971f">SQLManagerPRO.get_instance()</a>.get_session().query( classname ).filter e.g. <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1util_1_1sql_1_1SQLManagerPRO_1_1SQLManagerPRO.html#a8a56d22bd94d8752682edb42aa7d971f">SQLManagerPRO.get_instance()</a>.get_session().query( PROGene \ ).filter( PROGeneAlias.alias == "GADD34" ) </dd></dl>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keyword">def </span>query_PRO( self, classname, filter ):</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">return</span> eval( <span class="stringliteral">&#39;SQLManagerPRO.get_instance().get_session().query( &#39;</span> + classname + <span class="stringliteral">&#39;)&#39;</span> + filter + <span class="stringliteral">&#39;.distinct()&#39;</span> )</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    </div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="accb921b01dd83316a6053f6ed03f622e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb921b01dd83316a6053f6ed03f622e">&#9670;&nbsp;</a></span>filt_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fr.tagc.uorf.core.execution.FilterStrategy.FilterStrategy.filt_type</td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>CellContextCatalog and CellContext </h2>
<p>If there is one single entry in the list of cell contexts or if the filtering type has been set on 'union', then get the IDs of all the ORFTranscriptAsso entries associated at least with one of the cell contexts.</p>
<h2>ORFCategoryCatalog and ORFCategory </h2>
<p>If there is one single entry in the list of categories or if the filtering type has been set on 'union', then get the IDs of all the ORFTranscriptAsso entries associated at least with one of the categories.</p>
<h2>ORFAnnotationCatalog and ORFAnnotation </h2>
<p>If there is one single entry in the list of annotations or if the filtering type has been set on 'union', then get the IDs of all the ORFTranscriptAsso entries associated at least with one of the annotation. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/mnt/NAS7/Workspace/choteaus/tagc-uorf/project/01_ORF_datafreeze/06_src/fr/tagc/uorf/core/execution/FilterStrategy.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
