<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sORFdatafreezer: fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sORFdatafreezer
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>fr</b></li><li class="navelem"><b>tagc</b></li><li class="navelem"><b>uorf</b></li><li class="navelem"><b>core</b></li><li class="navelem"><b>execution</b></li><li class="navelem"><b>ResumeMergeStrategy</b></li><li class="navelem"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html">ResumeMergeStrategy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.png" usemap="#fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy_map" alt=""/>
  <map id="fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy_map" name="fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy_map">
<area href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html" alt="fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy" shape="rect" coords="0,0,428,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad141da10fb02355c32eb2d1a399d1113"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html#ad141da10fb02355c32eb2d1a399d1113">__init__</a> (self)</td></tr>
<tr class="separator:ad141da10fb02355c32eb2d1a399d1113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6864d7b3ff5842ef45d3ee102018b2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html#a2e6864d7b3ff5842ef45d3ee102018b2">execute</a> (self)</td></tr>
<tr class="separator:a2e6864d7b3ff5842ef45d3ee102018b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694035b11661b57477bfe4dcf8e9b39b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html#a694035b11661b57477bfe4dcf8e9b39b">merge_dsorftranscriptasso</a> (self)</td></tr>
<tr class="separator:a694035b11661b57477bfe4dcf8e9b39b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d18e1dff39cbfefc0462c929f72e282"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html#a9d18e1dff39cbfefc0462c929f72e282">import_dsorftranscriptasso_to_merge</a> (self)</td></tr>
<tr class="separator:a9d18e1dff39cbfefc0462c929f72e282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a></td></tr>
<tr class="memitem:a999869c415f278d64898cfc966900530 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a999869c415f278d64898cfc966900530">parse_config</a> (self)</td></tr>
<tr class="separator:a999869c415f278d64898cfc966900530 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa4cf77691658b414a5a109a3cef0a2 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a8aa4cf77691658b414a5a109a3cef0a2">copy_conserved_tables</a> (self)</td></tr>
<tr class="separator:a8aa4cf77691658b414a5a109a3cef0a2 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853e3c9d47078794ecb829fb5185e638 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a853e3c9d47078794ecb829fb5185e638">merge_dsorfs</a> (self)</td></tr>
<tr class="separator:a853e3c9d47078794ecb829fb5185e638 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd4005b55af502f76009505ae736193 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a6bd4005b55af502f76009505ae736193">merge_dstranscripts</a> (self)</td></tr>
<tr class="separator:a6bd4005b55af502f76009505ae736193 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b12d5286400a811fc83c1f86c25e74d inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a8b12d5286400a811fc83c1f86c25e74d">get_dsorftranscriptasso_to_merge</a> (self)</td></tr>
<tr class="separator:a8b12d5286400a811fc83c1f86c25e74d inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc08ae739263aa042c205f70e3bc040 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#afdc08ae739263aa042c205f70e3bc040">merge_dsota</a> (self)</td></tr>
<tr class="separator:afdc08ae739263aa042c205f70e3bc040 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f9c6169557031f5ff1c270f3761d060 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a9f9c6169557031f5ff1c270f3761d060">clean_pro_database</a> (self)</td></tr>
<tr class="separator:a9f9c6169557031f5ff1c270f3761d060 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06419bdc055688700361394430138509 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a06419bdc055688700361394430138509">batch_insert_to_PRO_db</a> (self, objects_to_insert, filename, process='Undefined process')</td></tr>
<tr class="separator:a06419bdc055688700361394430138509 inherit pub_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:af559d1ca95a227cea834b5a2aa92b9cd"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html#af559d1ca95a227cea834b5a2aa92b9cd">RESUME_AFTER_CONSERVED</a> = 'after_conserved'</td></tr>
<tr class="separator:af559d1ca95a227cea834b5a2aa92b9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a></td></tr>
<tr class="memitem:a71f015d744748095fd8c47d49b0bfcfa inherit pub_static_attribs_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a71f015d744748095fd8c47d49b0bfcfa">ATTRIBUTES_FOR_MERGING_SAME_DSORF</a></td></tr>
<tr class="separator:a71f015d744748095fd8c47d49b0bfcfa inherit pub_static_attribs_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a></td></tr>
<tr class="memitem:a89468c0136edff99d9ac22d5fb31a236 inherit pub_static_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a89468c0136edff99d9ac22d5fb31a236">save_list_of_obj</a> (objects_to_insert, filename)</td></tr>
<tr class="separator:a89468c0136edff99d9ac22d5fb31a236 inherit pub_static_methods_classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html">ResumeMergeStrategy</a> </h1>
<p>This class inherits from MergeStrategy and is a strategy aiming to re-start the merging from the checkpoint preceding its fail. It can resume at one of these points:</p><ul>
<li>After having successfully copying the content of "conserved" tables.</li>
<li>After having successfully computed and inserted the content of the ORF table.</li>
<li>After having successfully computed and inserted the content of the Transcript table.</li>
<li>After having successfully computed the ( ORF ID (PRO), Transcript ID (PRO) ) couples and saved the information in pickled files. NB: Resuming at this stage assumes that the dictionary that associates to each unique ( ORF ID (PRO), Transcript ID (PRO) ) couples to the list of all the DSORFTranscriptAsso (DS) that are related to it has already been successfully computed and saved.</li>
<li>During the merging of the DSORFTranscriptAsso entries (assuming it failed). NB: Resuming at this stage assumes that the dictionary that associates to each unique ( ORF ID (PRO), Transcript ID (PRO) ) couples to the list of all the DSORFTranscriptAsso (DS) that are related to it has already been successfully computed and saved.</li>
<li>After having successfully computed and inserted the content of the ORFTranscriptAsso table.</li>
</ul>
<p>NB: To run this strategy you need to ensure both the DS and PRO database have not been altered since (i.e. no strategy run since the merging that failed) and that temporary files (.dcorf) have not been compromised, renamed or move from their original location. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad141da10fb02355c32eb2d1a399d1113"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad141da10fb02355c32eb2d1a399d1113">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Constructor of <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1ResumeMergeStrategy_1_1ResumeMergeStrategy.html">ResumeMergeStrategy</a> </h2>
<p>Instance variables:</p><ul>
<li>configfile: String - The path to the config file.</li>
<li>species: String - The name of the species in the database.</li>
<li>sqce_consensus_ambig_threshold: Float[0,1] - The threshold to use to compute the sequence consensus interval.</li>
<li>max_len_diff_dsota_clust: Integer (&gt;0) - The maximal difference between the max. and min. lengths of DSORFTranscriptAsso entries to belong to the same "cluster".</li>
<li>thread_nb: Integer (&gt;0) - The number of threads that can be use.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>- When the name of the step at which resume the merging is unknown. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a13ba6c2d12de752a21b7ec2717553b0d">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">def </span>__init__( self ):</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        MergeStrategy.__init__( self )</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment"># Get the stage at which the Merge strategy has to be resumed</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        self.resume_at_stage = OptionManager.get_instance().get_option( OptionConstants.OPTION_RESUME_STEP_NAME,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                                                        not_none = <span class="keyword">True</span> )</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">not</span> <span class="keywordflow">in</span> ResumeMergeStrategy.RESUME_STAGES_LIST ):</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;The name of the last step successfully completed provided (&#39;</span> + </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                       self.resume_at_stage + <span class="stringliteral">&#39;) is not allowed.&#39;</span> +</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                       <span class="stringliteral">&#39; Please use one of the following list: &#39;</span> +</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                       <span class="stringliteral">&#39;, &#39;</span>.join( ResumeMergeStrategy.RESUME_STAGES_LIST ) + <span class="stringliteral">&#39;.&#39;</span> )</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    </div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2e6864d7b3ff5842ef45d3ee102018b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6864d7b3ff5842ef45d3ee102018b2">&#9670;&nbsp;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy.execute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>execute </h2>
<p>Execute the strategy to complete the ORFTranscriptAsso table (PRO database) by merging the entries of the DSORFTranscriptAsso table (DS database).</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>- When an exception has been raised during the DatabaseCheck. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>- When a table that is expected to be filled in is empty. </td></tr>
    <tr><td class="paramname">DenCellORFException</td><td>- When an error occurred during the execution of a MergeStrategy method. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a1cea36b0b441a121fd33ff5fc0194242">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">def </span>execute( self ):</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment"># Run DatabaseCheck in order to check the DS and PRO databases are </span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment"># reachable prior to resume the merging</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Checking the databases prior to resume the merging...&#39;</span> )</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            DatabaseCheckStrategy().execute()</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;An error occurred whilst checking the database prior to&#39;</span> +</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                       <span class="stringliteral">&#39; merge the DSORFTranscriptAsso entries.&#39;</span> +</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                       <span class="stringliteral">&#39;\n Error code: &#39;</span> + LogCodes.ERR_DBCHECK + <span class="stringliteral">&#39;.&#39;</span>, e )</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        </div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        </div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment"># Delete the content of some tables if necessary</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment"># ----------------------------------------------</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            </div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment"># Remove the eventual content of the ORF table and of its children</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED ] ):</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                SQLManagerPRO.get_instance().get_session().query( ORF ).delete()</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                           <span class="stringliteral">&#39; delete all the entries of the ORF table.&#39;</span> , e )</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                SQLManagerPRO.get_instance().commit()</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment"># Remove the eventual content of the Transcript table and of its children</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF ] ):</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                SQLManagerPRO.get_instance().get_session().query( Transcript ).delete()</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                           <span class="stringliteral">&#39; delete all the entries of the Transcript table.&#39;</span> , e )</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                SQLManagerPRO.get_instance().commit()</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment"># Remove the eventual content of the ORFTranscriptAsso table and of its children</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO ] ):</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                SQLManagerPRO.get_instance().get_session().query( ORFTranscriptAsso ).delete()</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                           <span class="stringliteral">&#39; delete all the entries of the ORFTranscriptAsso table.&#39;</span> , e )</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                SQLManagerPRO.get_instance().commit()</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment"># Check the content of tables that are expected </span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment"># to contain entries</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment"># ---------------------------------------------</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                              </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment"># Check the conserved tables </span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                       ResumeMergeStrategy.RESUME_DURING_OTA,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA ] ):</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            prometadata_count = SQLManagerPRO.get_instance().get_session().query( PROMetadata ).count()</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            progene_count = SQLManagerPRO.get_instance().get_session().query( PROGene ).count()</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            progenealias_count = SQLManagerPRO.get_instance().get_session().query( PROGeneAlias ).count()</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">if</span> ( ( prometadata_count == 0 ) </div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                 <span class="keywordflow">or</span> ( progene_count == 0 )</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                 <span class="keywordflow">or</span> ( progenealias_count == 0 ) ):</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): One of the &quot;conserved&quot; table&#39;</span> +</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                           <span class="stringliteral">&#39; is empty when it is expected to be filled in (PROMetadata: &#39;</span> +</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                           str( prometadata_count ) + <span class="stringliteral">&#39;, PROGene: &#39;</span> + str( progene_count ) +</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                           <span class="stringliteral">&#39;, PROGeneAlias: &#39;</span> + str( progenealias_count ) )</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                </div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment"># Check the ORF table</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                       ResumeMergeStrategy.RESUME_DURING_OTA,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA ] ):</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            orf_count = SQLManagerPRO.get_instance().get_session().query( ORF ).count()</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> ( orf_count == 0 ):</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): The ORF table does not contain&#39;</span> +</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                           <span class="stringliteral">&#39; any entry whilst the merging of DSORFs is expected to have&#39;</span> +</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                           <span class="stringliteral">&#39; been completed successfully.&#39;</span> )</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment"># Check the Transcript table</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                       ResumeMergeStrategy.RESUME_DURING_OTA,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA ] ):</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            transcript_count = SQLManagerPRO.get_instance().get_session().query( Transcript ).count()</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keywordflow">if</span> ( transcript_count == 0 ):</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): The Transcript table does not&#39;</span> +</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                           <span class="stringliteral">&#39; contain any entry whilst the merging of DSTranscripts is&#39;</span> +</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                           <span class="stringliteral">&#39; expected to have been completed successfully.&#39;</span> )</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment"># Check the ORFTranscriptAsso table</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_OTA ] ):</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            ota_count = SQLManagerPRO.get_instance().get_session().query( ORFTranscriptAsso ).count()</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> ( ota_count == 0 ):</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): The ORFTranscriptAsso table does not&#39;</span> +</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                           <span class="stringliteral">&#39; contain any entry whilst the merging of DSORFTranscriptAsso is&#39;</span> +</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                           <span class="stringliteral">&#39; expected to have been completed successfully.&#39;</span> )</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment"># Resume the merging</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment"># ------------------</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        </div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment"># Merge the same ORFs together</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED ] ):</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                self.merge_dsorfs()</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                           <span class="stringliteral">&#39; merge the DSORF entries.&#39;</span>, e )</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment"># Merge the same transcripts together</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF ] ):</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                self.merge_dstranscripts()</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                           <span class="stringliteral">&#39; merge the DSTranscript entries.&#39;</span>, e )</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        </div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment"># Recover all the DSORFTranscriptAsso, and associate them with their actual ORFs and transcript</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                       ResumeMergeStrategy.RESUME_DURING_OTA ] ):</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                self.merge_dsorftranscriptasso()</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                           <span class="stringliteral">&#39; merge the DSORFTranscriptAsso entries.&#39;</span>, e )</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment"># Clean the database by removing parent entries that have no child</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                       ResumeMergeStrategy.RESUME_DURING_OTA,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_OTA ] ):</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                self.clean_pro_database()</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                           <span class="stringliteral">&#39; clean the database after merging.&#39;</span>, e )</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<a id="a9d18e1dff39cbfefc0462c929f72e282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d18e1dff39cbfefc0462c929f72e282">&#9670;&nbsp;</a></span>import_dsorftranscriptasso_to_merge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy.import_dsorftranscriptasso_to_merge </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>import_dsorftranscriptasso_to_merge </h2>
<p>This method allows to generate the dictionary that associates to each unique ( ORF ID (PRO), Transcript ID (PRO) ) couple that exists the list of all the DSORFTranscriptAsso (DS) that are related to it using the dictionary of IDs saved during the initial run of the Merge strategy and to to store this dictionary in the DataManager main dictionary. </p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">def </span>import_dsorftranscriptasso_to_merge( self ):</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        Logger.get_instance().debug( <span class="stringliteral">&#39;ResumeMergeStrategy.get_dsorftranscriptasso_to_merge():&#39;</span> +</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                     <span class="stringliteral">&#39; Getting the dictionary that associate to each existing&#39;</span> +</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                     <span class="stringliteral">&#39; ( ORF ID, Transcript ID ) couples the list of DSORFTranscriptAsso&#39;</span> +</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                     <span class="stringliteral">&#39; (DS) IDs and converting lists of IDs into list of objects.&#39;</span>)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment"># Get the dictionary that associates to each unique ( ORF ID (PRO), </span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment"># Transcript ID (PRO) ) couple that exists the list of the IDs of </span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="comment"># all the DSORFTranscriptAsso (DS) that are related to it </span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        all_existing_orf_tr_asso_ids = FileHandlerUtil.get_obj_from_file( input_folder = Constants.MERGED_DATA_FOLDER,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                                          filename = Constants.ALL_EXISTING_ORF_TR_ASSO_IDS_FILENAME )</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        </div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment"># Convert the dictionary in order to change the list of IDs</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment"># by lists of corresponding DSORFTranscriptAsso objects</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        all_dsota = SQLManagerDS.get_instance().get_session().query( DSORFTranscriptAsso ).all()</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        all_dsota_dict = {}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">for</span> dsota <span class="keywordflow">in</span> all_dsota:</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            all_dsota_dict[ dsota.id ] = dsota</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        existing_orf_tr_asso_all = {}</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">for</span> ( ( orf_id, tr_id ), dsota_ids_list ) <span class="keywordflow">in</span> all_existing_orf_tr_asso_ids.items():</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            existing_orf_tr_asso_all[ ( orf_id, tr_id ) ] = map( <span class="keyword">lambda</span> x: all_dsota_dict.get( x ), dsota_ids_list )</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment"># If the merging of DSORFTranscriptAsso entries has already </span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment"># been started once and failed, then remove from the list </span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment"># all the (ORF ID, Transcript ID) couples already processed </span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage == ResumeMergeStrategy.RESUME_DURING_OTA ):</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            all_processed_ota = SQLManagerPRO.get_instance().get_session().query( ORFTranscriptAsso ).all()</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            SQLManagerPRO.get_instance().close_session()</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            </div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            all_processed_ids = [ ( ota.orf_id, ota.transcript_id ) <span class="keywordflow">for</span> ota <span class="keywordflow">in</span> all_processed_ota ]</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            existing_orf_tr_asso_all_to_process = { key : val \</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                                    <span class="keywordflow">for</span> ( key, val ) <span class="keywordflow">in</span> existing_orf_tr_asso_all.items() \</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                                    <span class="keywordflow">if</span> ( ( int( key[0] ), int( key[1] ) ) <span class="keywordflow">not</span> <span class="keywordflow">in</span> all_processed_ids ) }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            existing_orf_tr_asso_all = existing_orf_tr_asso_all_to_process</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            Logger.get_instance().debug( <span class="stringliteral">&#39;ResumeMergeStrategy.import_dsorftranscriptasso_to_merge(): &#39;</span> +</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                         str( len( all_processed_ota ) ) + <span class="stringliteral">&#39; couples have already been&#39;</span> +</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                         <span class="stringliteral">&#39; processed and &#39;</span> + str( len( existing_orf_tr_asso_all.keys() ) ) + </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                         <span class="stringliteral">&#39; remains to be processed.&#39;</span> )</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        </div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment"># Store the dictionary in the DataManager main dictionary</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        DataManager.get_instance().store_data( Constants.DM_ALL_EXISTING_ORF_TR_ASSO_DICT, existing_orf_tr_asso_all )</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        </div></div><!-- fragment -->
</div>
</div>
<a id="a694035b11661b57477bfe4dcf8e9b39b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a694035b11661b57477bfe4dcf8e9b39b">&#9670;&nbsp;</a></span>merge_dsorftranscriptasso()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy.merge_dsorftranscriptasso </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>merge_dsorftranscriptasso </h2>
<p>This method aims to process the entries of the DSORFTranscriptAsso table (DS database) to fill in the ORFTranscriptAsso table (PRO database). It first gets the list of all ( ORF, Transcript ) couples that exist and for each of them it gets the list of all DSORFTranscriptAsso corresponding to the couple. Then it merges the DSORFTranscriptAsso together in order to create one single entry associated with the couple in the ORFTranscriptAsso table (PRO database). </p>

<p>Reimplemented from <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1MergeStrategy_1_1MergeStrategy.html#a69763877faecc4732eed2ab09cf32453">fr.tagc.uorf.core.execution.MergeStrategy.MergeStrategy</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keyword">def </span>merge_dsorftranscriptasso( self ):</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Starting to merge the entries of the DSORFTranscriptAsso table.&#39;</span> )</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment"># Get all the existing ( ORF, Transcript ) couples for which this </span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment"># is necessary to merge all the related DSORFTranscriptAsso</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment"># If they have not yet been computed, then do it</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_CONSERVED,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_ORF,</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                       ResumeMergeStrategy.RESUME_AFTER_TRANSCRIPT ] ):</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            self.get_dsorftranscriptasso_to_merge()</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment"># Otherwise import them from the .dcorf file</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">elif</span> ( self.resume_at_stage <span class="keywordflow">in</span> [ ResumeMergeStrategy.RESUME_AFTER_OTA_ID_ASSO,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                         ResumeMergeStrategy.RESUME_DURING_OTA ] ):</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            self.import_dsorftranscriptasso_to_merge()</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment"># Any other case that is not handle should raise a programming exception</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;ResumeMergeStrategy.merge_dsorftranscriptasso(): The case &#39;</span> +</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                       self.resume_at_stage + <span class="stringliteral">&#39; is not properly handled in the method!&#39;</span> +</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                       <span class="stringliteral">&#39; Please contact the developer if you see this message.&#39;</span> )</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment"># Merge the entries of the DSORFTranscriptAsso table        </span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        self.merge_dsota()</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af559d1ca95a227cea834b5a2aa92b9cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af559d1ca95a227cea834b5a2aa92b9cd">&#9670;&nbsp;</a></span>RESUME_AFTER_CONSERVED</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string fr.tagc.uorf.core.execution.ResumeMergeStrategy.ResumeMergeStrategy.RESUME_AFTER_CONSERVED = 'after_conserved'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>Class variables </h2>
<p>Resume after having successfully copying the content of "conserved" tables </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/mnt/NAS7/Workspace/choteaus/tagc-uorf/project/01_ORF_datafreeze/06_src/fr/tagc/uorf/core/execution/ResumeMergeStrategy.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
