<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sORFdatafreezer: fr.tagc.uorf.core.execution.DeletionStrategy.DeletionStrategy Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sORFdatafreezer
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>fr</b></li><li class="navelem"><b>tagc</b></li><li class="navelem"><b>uorf</b></li><li class="navelem"><b>core</b></li><li class="navelem"><b>execution</b></li><li class="navelem"><b>DeletionStrategy</b></li><li class="navelem"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html">DeletionStrategy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">fr.tagc.uorf.core.execution.DeletionStrategy.DeletionStrategy Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Inherits object.</p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abfbee143130dfb21310ffd01a886301b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html#abfbee143130dfb21310ffd01a886301b">__init__</a> (self)</td></tr>
<tr class="separator:abfbee143130dfb21310ffd01a886301b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd88b4b9a32c713674e9de655b6f4f9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html#a2dd88b4b9a32c713674e9de655b6f4f9">execute</a> (self)</td></tr>
<tr class="separator:a2dd88b4b9a32c713674e9de655b6f4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:add12d7593111715940c346b6660df142"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html#add12d7593111715940c346b6660df142">delete_datasource</a> (data_source)</td></tr>
<tr class="separator:add12d7593111715940c346b6660df142"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h1><a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html">DeletionStrategy</a> </h1>
<p>This class allows to remove from the database all the entries related to a particular data source. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="abfbee143130dfb21310ffd01a886301b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfbee143130dfb21310ffd01a886301b">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.DeletionStrategy.DeletionStrategy.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>Constructor of <a class="el" href="classfr_1_1tagc_1_1uorf_1_1core_1_1execution_1_1DeletionStrategy_1_1DeletionStrategy.html">DeletionStrategy</a> </h2>
<p>Instance variables:</p><ul>
<li>db_settings: Dictionary - A dictionary of settings. This may include:<ul>
<li>The database name.</li>
<li>The database type (SQLite / MySQL).</li>
<li>For SQLite databases: the folder of SQLite file.</li>
<li>For MySQL databases: the MySQL user, password, host IP and port.</li>
</ul>
</li>
<li>datasource: List of strings - The list of data sources to delete.</li>
</ul>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When the name of the data source(s) is (are) not provided, or cannot be converted into a list. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">def </span>__init__( self ):</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        </div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="comment"># Get the options necessary to establish the connection to the database</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        self.db_settings = {}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        self.db_settings[ Constants.DB_SETTINGS_DB_TYPE ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_TYPE )</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        self.db_settings[ Constants.DB_SETTINGS_DB_NAME ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_NAME, </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                                                                                     not_none = <span class="keyword">True</span> )</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        </div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span> ( self.db_settings[ Constants.DB_SETTINGS_DB_TYPE ] == SQLConstants.DB_TYPE_MYSQL ):</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            self.db_settings[ Constants.DB_SETTINGS_MYSQL_USER ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_MYSQL_USER )</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            self.db_settings[ Constants.DB_SETTINGS_MYSQL_PASSWD ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_MYSQL_PASSWD )</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            self.db_settings[ Constants.DB_SETTINGS_MYSQL_HOST ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_MYSQL_HOST_IP )</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            self.db_settings[ Constants.DB_SETTINGS_MYSQL_PORT ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_MYSQL_PORT )</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            </div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">elif</span> ( self.db_settings[ Constants.DB_SETTINGS_DB_TYPE ] == SQLConstants.DB_TYPE_SQLITE ):</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            self.db_settings[ Constants.DB_SETTINGS_DB_FOLDER ] = OptionManager.get_instance().get_option( OptionConstants.OPTION_DB_FOLDER )</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment"># Get the list of data sources to delete</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            datasource = OptionManager.get_instance().get_option( OptionConstants.OPTION_SOURCE_NAME, </div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                                                  not_none = <span class="keyword">True</span> )</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;An error occurred trying to get the list of sources to remove&#39;</span> +</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                       <span class="stringliteral">&#39; from the database.&#39;</span>, e )</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="comment"># Convert the string containing the data sources to delete into a list</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> datasource:</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">if</span> isinstance( datasource, basestring ):</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                self.datasource = datasource.split( <span class="stringliteral">&#39;,&#39;</span> )</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;DeletionStrategy: The name of the source(s) has to be&#39;</span> +</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                           <span class="stringliteral">&#39; provided as a single string. If there are several&#39;</span> +</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                           <span class="stringliteral">&#39; sources to remove from the database, the sources needs&#39;</span> +</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                           <span class="stringliteral">&#39; to be provided as comma-separated list.&#39;</span> +</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                           <span class="stringliteral">&#39; Please see the documentation for more information.&#39;</span> )</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;DeletionStrategy: The name of the source(s) to remove&#39;</span> +</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                       <span class="stringliteral">&#39; has (have) to be provided!&#39;</span> )</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    </div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="add12d7593111715940c346b6660df142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add12d7593111715940c346b6660df142">&#9670;&nbsp;</a></span>delete_datasource()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.DeletionStrategy.DeletionStrategy.delete_datasource </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data_source</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<h2>delete_datasource </h2>
<p>This is a static method that allows to delete from the database the entries related to a particular data source. NB: Please note that this method removes the ORF, Transcript and ORFTranscriptAsso entries related to the provided data source, but DO NOT remove the Gene and GeneAlias entries that have been created during the parsing and insertion of data of the source and that are no more used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_source</td><td>String - The name of the data source to delete from the database.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When a exception has been raised trying to delete the objects from the session or trying to commit the session. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keyword">def </span>delete_datasource( data_source ):</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment"># For an easier manipulation of data stored in the DataManager, </span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment"># assign a new variable to access the list of data sources</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        all_datasources = DataManager.get_instance().get_data( Constants.DM_ALL_DATASOURCES )</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="comment"># Check that the source is in the database</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        ds = DataSource( name = data_source )</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        existing_ds = all_datasources.get( ds )</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> ( <span class="keywordflow">not</span> existing_ds ):</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            Logger.get_instance().info( <span class="stringliteral">&#39;The source &quot;&#39;</span> + data_source + <span class="stringliteral">&#39;&quot; cannot be found in the database.&#39;</span> +</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                        <span class="stringliteral">&#39; Hence, no data will be deleted from this source.&#39;</span> )</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="comment"># Queries to perform to get the entries related to the data source</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            datasource_to_delete = SQLManagerDS.get_instance().get_session().query( DataSource ).filter( DataSource.name == data_source )</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            dsorfs_to_delete_qr = SQLManagerDS.get_instance().get_session().query( DSORF ).filter( DSORF.data_source == data_source )</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            dstranscripts_to_delete_qr = SQLManagerDS.get_instance().get_session().query( DSTranscript ).filter( DSTranscript.data_source == data_source )</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            dsorftranscriptasso_to_delete_qr = SQLManagerDS.get_instance().get_session().query( DSORFTranscriptAsso ).filter( DSORFTranscriptAsso.data_source == data_source )</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            utdstranscriptgeneconflict_to_delete_qr = SQLManagerDS.get_instance().get_session().query( UTDSTranscriptGeneConflict ).filter( UTDSTranscriptGeneConflict.data_source == data_source )</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="comment"># Ask the user to confirm the deletion of the data source</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            total_to_delete = ( datasource_to_delete.count() + </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                dsorfs_to_delete_qr.count() + </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                dstranscripts_to_delete_qr.count() + </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                dsorftranscriptasso_to_delete_qr.count() )</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            Logger.get_instance().info( str( dsorfs_to_delete_qr.count() ) + <span class="stringliteral">&#39; DSORF, &#39;</span> +</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                        str( dstranscripts_to_delete_qr.count() ) + <span class="stringliteral">&#39; DSTranscript, and &#39;</span> +</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                        str( dsorftranscriptasso_to_delete_qr.count() ) + </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                        <span class="stringliteral">&#39; DSORFTranscriptAsso entries (total of &#39;</span> + </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                        str( total_to_delete ) + <span class="stringliteral">&#39; entries)&#39;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                        <span class="stringliteral">&#39; have been found related to the data source &#39;</span> + data_source +</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                        <span class="stringliteral">&#39; and are about to be deleted from the database.&#39;</span> )</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            </div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            confirm_deletion = <span class="keywordtype">None</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordflow">while</span> ( confirm_deletion <span class="keywordflow">not</span> <span class="keywordflow">in</span> [ <span class="stringliteral">&#39;Y&#39;</span>, <span class="stringliteral">&#39;N&#39;</span> ] ):</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                print( <span class="stringliteral">&#39;Do you want to proceed to the deletion? (Y/N)&#39;</span> )</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                confirm_deletion = raw_input().upper()</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            </div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment"># Delete the objects from the database if the deletion has been confirmed</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">if</span> ( confirm_deletion == <span class="stringliteral">&#39;Y&#39;</span> ):</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    datasource_to_delete.delete()</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    utdstranscriptgeneconflict_to_delete_qr.delete()</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="keywordflow">except</span> DenCellORFException <span class="keyword">as</span> e:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;DeletionStrategy.execute(): An error occurred trying&#39;</span> +</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                               <span class="stringliteral">&#39; to delete all the entries related to &#39;</span> + data_source + </div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                               <span class="stringliteral">&#39; from the session.&#39;</span>, e )</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    </div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="comment"># Commit the changes</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    SQLManagerDS.get_instance().commit()</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;DeletionStrategy.execute(): An error occurred trying to&#39;</span> +</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                               <span class="stringliteral">&#39; commit the changes after deletion of the entries related to &#39;</span> +</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                               data_source + <span class="stringliteral">&#39; from the session.&#39;</span>, e )</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <span class="comment"># Log in debug mode the number of objects successfully deleted</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    Logger.get_instance().debug( <span class="stringliteral">&#39;InsertionStrategy.execute(): the objects related to &#39;</span> +</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                 data_source + <span class="stringliteral">&#39; have been successfully deleted from&#39;</span> +</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                                 <span class="stringliteral">&#39; the database.&#39;</span> )</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                </div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                Logger.get_instance().info( <span class="stringliteral">&#39;Deletion of data related to &#39;</span> + data_source + </div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                            <span class="stringliteral">&#39; aborted by the user.&#39;</span> )</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            </div></div><!-- fragment -->
</div>
</div>
<a id="a2dd88b4b9a32c713674e9de655b6f4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dd88b4b9a32c713674e9de655b6f4f9">&#9670;&nbsp;</a></span>execute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def fr.tagc.uorf.core.execution.DeletionStrategy.DeletionStrategy.execute </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>execute </h2>
<p>Execute the strategy to remove from the database any data related to the data source provided.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">DenCellORFException</td><td>When a connection to the DS database cannot be created. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">def </span>execute( self ):</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        </div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="comment"># Create a session to the DS database</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        SQLManagerDS.get_instance().set_db_settings( self.db_settings )</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">try</span>:</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            SQLManagerDS.get_instance().get_session()</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">raise</span> DenCellORFException( <span class="stringliteral">&#39;DeletionStrategy.execute(): An error occurred while trying to&#39;</span> +</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                       <span class="stringliteral">&#39; create a session to the database.&#39;</span> +</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                        <span class="stringliteral">&#39;\n Error code: &#39;</span> + LogCodes.ERR_SQL_SESSION + <span class="stringliteral">&#39;.&#39;</span>, e)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            </div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment"># Get the list of entries in the DataSource table and store them in the DataManager</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        DataManager.get_instance().store_DS_query_result( Constants.DM_ALL_DATASOURCES, </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                          <span class="stringliteral">&#39;query( DataSource ).all()&#39;</span> )</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        SQLManagerDS.get_instance().close_session()</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment"># Process to the deletion of data</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Starting the deletion of data.&#39;</span> )</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        </div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">for</span> data_source <span class="keywordflow">in</span> self.datasource:</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                self.delete_datasource( data_source )</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                Logger.get_instance().error( <span class="stringliteral">&#39;An error occurred trying to delete the data related to &#39;</span> +</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                             data_source + <span class="stringliteral">&#39;\n&#39;</span> + str( e ) + <span class="stringliteral">&#39;.&#39;</span> +</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                             <span class="stringliteral">&#39; Error code: &#39;</span> + LogCodes.ERR_DELETE_DS + <span class="stringliteral">&#39;.&#39;</span>,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                             ex = <span class="keyword">False</span> )</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                        </div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment"># Log the end of the deletion</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        Logger.get_instance().info( <span class="stringliteral">&#39;Deletion of data has finished.&#39;</span> )</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    </div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    </div></div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/mnt/NAS7/Workspace/choteaus/tagc-uorf/project/01_ORF_datafreeze/06_src/fr/tagc/uorf/core/execution/DeletionStrategy.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
